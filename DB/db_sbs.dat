-------[ 2021-01-01 00:00:00 ]


## track constraint widths:
sbs.frontconstraintwidth_x = 0.75 # m
sbs.frontconstraintwidth_y = 0.25 # m
sbs.backconstraintwidth_x = 0.28 # m
sbs.backconstraintwidth_y = 0.23 # m
sbs.backconstraint_x0 = 0.0 #0.5 
sbs.backconstraint_y0 = -0.0042
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

#sbs.gemorigin_xyz = 0.0 0.0 4.825

# after redefining transformation for SBS GEMs:

#sbs.gemorigin_xyz =  -0.00477348  0.000756327       4.6703
#sbs.gemangles_xyz =    -0.126063     0.259251    -0.789679

# alignment without offset of HCAL (probably won't make much difference):

#sbs.gemorigin_xyz =   -0.0020234  0.000756829       4.1203
#sbs.gemangles_xyz =     -0.12607     0.297492    -0.789679


#the optics matrix elements below are for SBS 100% field setting (using approximation of uniform field in the magnet gap):
sbs.precon_flag = 0

sbs.optics_order = 2

# SBS 50% field for GEN configuration:
sbs.optics_parameters =
 -4.7492373e-05 -3.0076826e-05  9.7658771e-05      0.2368548  0 0 0 0 0
     0.29406313  -0.0022728891   0.0074340655   0.0016531116  1 0 0 0 0
 -0.00079535663   0.0034732323  -0.0087346869   0.0070309193  2 0 0 0 0
   0.0013825575  -0.0060321865      1.0274256  -0.0051965265  0 1 0 0 0
     0.11963484    0.026855614    -0.12483853    0.018499472  1 1 0 0 0
  -0.0054083514     0.05759505    -0.19453195    0.059565112  0 2 0 0 0
     -0.4195945    0.010480438   -0.035369236  -0.0098816328  0 0 1 0 0
    0.010900296   -0.030027456     0.08358603   -0.014998565  1 0 1 0 0
    -0.14793145    -0.12402843     0.58081927    -0.08525447  0 1 1 0 0
   -0.034567836     0.06354853    -0.19160053    0.044249134  0 0 2 0 0
  -0.0055976765      1.0273391     -4.9440968     0.01696626  0 0 0 1 0
    -0.58097842    -0.11795225     0.51742424   -0.061321435  1 0 0 1 0
    0.053480872     -0.4504135      1.5539073     -0.4541342  0 1 0 1 0
      0.7499874     0.61478662     -2.6543871     0.27831895  0 0 1 1 0
    -0.12665448     0.91037838      -3.197888     0.93866798  0 0 0 2 0
  5.3330367e-15  2.8911089e-14 -1.0816528e-13 -1.9194737e-14  0 0 0 0 1
 -1.9401887e-15 -4.1937965e-15  1.7721383e-14 -2.1850874e-14  1 0 0 0 1
  1.0722579e-15  7.7445726e-16 -3.7688536e-15  2.6770205e-15  0 1 0 0 1
  7.5106687e-16 -1.1950822e-15  9.8391957e-15 -1.2347115e-15  0 0 1 0 1
  2.3646997e-16 -1.1667667e-16 -1.9264282e-16 -5.6474397e-16  0 0 0 1 1
  3.2742694e-16  -1.094353e-15  3.2631097e-15  -1.518398e-15  0 0 0 0 2

# SBS 30% field for GEN configuration:
sbs.optics_parameters = 
 -3.9793076e-05 -0.00021958306  0.00077632912     0.14539652  0 0 0 0 0
     0.29362296 -0.00040166393   0.0022051916   0.0073454874  1 0 0 0 0
  0.00054633448  0.00089942297   0.0023068647  -0.0054110009  2 0 0 0 0
 -0.00025350036  -0.0047118895      1.0244949 -0.00045551193  0 1 0 0 0
     0.12749638    0.032892231    -0.16313876  -0.0014421081  1 1 0 0 0
   0.0033025146    0.051561798    -0.20332191    0.051639733  0 2 0 0 0
    -0.41796005   0.0020721824   -0.013641984   -0.035952964  0 0 1 0 0
   0.0031019379  -0.0094061969  -0.0049763021     0.07858849  1 0 1 0 0
    -0.18241576    -0.16207846     0.81647553    0.026106389  0 1 1 0 0
   -0.024779755    0.019820787   -0.014255702    -0.17153092  0 0 2 0 0
  0.00090686829      1.0195593     -4.9255022   -0.002373647  0 0 0 1 0
    -0.61557426    -0.13473266     0.65092994    0.021849731  1 0 0 1 0
   -0.024288308    -0.40223151      1.6266844    -0.41666754  0 1 0 1 0
     0.90072772     0.71085083     -3.4025141    -0.18276902  0 0 1 1 0
    0.035062243     0.80870167     -3.3436212     0.80097896  0 0 0 2 0
 -1.3192296e-14  3.4895072e-15 -2.3328211e-14 -2.3491218e-14  0 0 0 0 1
 -1.3821117e-15 -3.4791546e-15  1.1404732e-14  6.1396022e-15  1 0 0 0 1
  2.1336319e-15  2.9729321e-16 -1.0681814e-15 -2.6072193e-15  0 1 0 0 1
  1.5618654e-15   -9.90699e-16  4.0941642e-15 -4.1829097e-16  0 0 1 0 1
  5.1697134e-16  1.2310463e-16 -8.6493022e-16 -5.9245231e-16  0 0 0 1 1
  4.5944684e-16  6.6524697e-17  2.8352903e-16 -9.1314535e-16  0 0 0 0 2

--------[ 2022-10-14 00:00:00 ] # start GEN-2 kinematics: here we mainly run with SBS at full field:

sbs.gemorigin_xyz =  -0.00102233   0.00070928      4.40
sbs.gemangles_xyz =     0.121055    -0.308798    -0.799353

# SBS 100% field for GEN configuration... BdL ~= 1.58 T*m
sbs.optics_parameters =
  -0.0003513201  5.3757169e-05  0.00839405534      0.3902228  0 0 0 0 0
     0.27931137 -6.4786094e-05   0.1007172775    0.001446896  1 0 0 0 0
  0.00046508419 -0.00040215314   0.1514340977   0.0076777109  2 0 0 0 0
  0.00039824129  -0.0014993516       0.925907 -0.00018809634  0 1 0 0 0
     0.12583597   0.0093546922   -0.038057985   0.0032724021  1 1 0 0 0
   0.0050509875   0.0047190471   0.0093248106    0.038019853  0 2 0 0 0
    -0.49294892  0.00081299015  -0.0056427729   -1.21939953  0 0 1 0 0
   0.0063149389   0.0020891526  -0.0060265101   0.0030162675  1 0 1 0 0
    -0.17285935   -0.040700375     0.16129629   -0.012315548  0 1 1 0 0
   -0.039082297    -0.00128007   -0.001709668    -3.5100546  0 0 2 0 0
  -0.0040627701      1.0170874     -4.8926068   -0.002228922  0 0 0 1 0
    -0.59575772   -0.049546309     0.21091191  -0.0056070761  1 0 0 1 0
   -0.025402411   -0.037685667   -0.035912365    -0.21797913  0 1 0 1 0
     0.81142079     0.33997576     -1.3319419    0.029927015  0 0 1 1 0
    0.025431516    0.067446723    0.028925304     0.33807591  0 0 0 2 0
 -7.2130705e-16   2.395829e-15 -6.7074436e-16  2.8011489e-14  0 0 0 0 1
 -8.0344008e-16 -8.4204583e-15  4.6113261e-14 -7.7975922e-15  1 0 0 0 1
 -2.1963046e-16 -7.8606246e-16  2.4646817e-15 -1.0909688e-14  0 1 0 0 1
 -3.7147256e-16 -8.8648438e-16  6.0221692e-15  1.3425275e-14  0 0 1 0 1
 -3.3139766e-16 -5.5967834e-17 -3.8427815e-16 -9.6972098e-15  0 0 0 1 1
 -2.4792623e-16  2.7226815e-16 -1.3185506e-15 -8.6599971e-16  0 0 0 0 2


--------[ 2022-11-07 00:00:00 ] #optics for GEN3

sbs.gemorigin_xyz =  -0.00102233   0.00070928      4.40
sbs.gemangles_xyz =     0.121055    -0.308798    -0.799353

#after the new alignment correcting for the x and theta correlations
sbs.optics_parameters =
  -0.0003513201  5.3757169e-05 0.00839405534      0.4422228  0 0 0 0 0
     0.27931137 -6.4786094e-05   0.0507172775    0.021446896  1 0 0 0 0
  0.00046508419 -0.00040215314   0.0014340977   0.0076777109  2 0 0 0 0
  0.00039824129  -0.0014993516       0.925907 -0.00018809634  0 1 0 0 0
     0.12583597   0.0093546922   -0.038057985   0.0032724021  1 1 0 0 0
   0.0050509875   0.0047190471   0.0093248106    0.038019853  0 2 0 0 0
    -0.49294892  0.00081299015  0.0056427729   -0.66939953  0 0 1 0 0
   0.0063149389   0.0020891526  -0.0060265101   0.0030162675  1 0 1 0 0
    -0.17285935   -0.040700375     0.16129629   -0.012315548  0 1 1 0 0
   -0.039082297    -0.00128007   -0.001709668    -2.0100546  0 0 2 0 0
  -0.0040627701      1.0170874     -4.8926068   -0.203228922  0 0 0 1 0
    -0.59575772   -0.049546309     0.21091191  -0.0056070761  1 0 0 1 0
   -0.025402411   -0.037685667   -0.035912365    -0.21797913  0 1 0 1 0
     0.81142079     0.33997576     -1.3319419    0.029927015  0 0 1 1 0
    0.025431516    0.067446723    0.028925304     0.33807591  0 0 0 2 0
 -7.2130705e-16   2.395829e-15 -6.7074436e-16  2.8011489e-14  0 0 0 0 1
 -8.0344008e-16 -8.4204583e-15  4.6113261e-14 -7.7975922e-15  1 0 0 0 1
 -2.1963046e-16 -7.8606246e-16  2.4646817e-15 -1.0909688e-14  0 1 0 0 1
 -3.7147256e-16 -8.8648438e-16  6.0221692e-15  1.3425275e-14  0 0 1 0 1
 -3.3139766e-16 -5.5967834e-17 -3.8427815e-16 -9.6972098e-15  0 0 0 1 1
 -2.4792623e-16  2.7226815e-16 -1.3185506e-15 -8.6599971e-16  0 0 0 0 2


-------[ 2023-01-12 00:00:00 ]  #optics parameters for GEN4a kinematic

sbs.gemorigin_xyz =  -0.00102233   0.00070928      4.40
sbs.gemangles_xyz =     0.121055    -0.308798    -0.799353

#after the new alignment correcting for the x and theta correlations
sbs.optics_parameters =
  -0.0003513201  5.3757169e-05 0.00839405534      0.4562228  0 0 0 0 0
     0.27931137 -6.4786094e-05   0.0507172775    0.001446896  1 0 0 0 0
  0.00046508419 -0.00040215314   0.0014340977   0.0076777109  2 0 0 0 0
  0.00039824129  -0.0014993516       0.925907 -0.00018809634  0 1 0 0 0
     0.12583597   0.0093546922   -0.038057985   0.0032724021  1 1 0 0 0
   0.0050509875   0.0047190471   0.0093248106    0.038019853  0 2 0 0 0
    -0.49294892  0.00081299015  0.0056427729   -0.56939953  0 0 1 0 0
   0.0063149389   0.0020891526  -0.0060265101   0.0030162675  1 0 1 0 0
    -0.17285935   -0.040700375     0.16129629   -0.012315548  0 1 1 0 0
   -0.039082297    -0.00128007   -0.001709668    -2.0100546  0 0 2 0 0
  -0.0040627701      1.0170874     -4.8926068   -0.202228922  0 0 0 1 0
    -0.59575772   -0.049546309     0.21091191  -0.0056070761  1 0 0 1 0
   -0.025402411   -0.037685667   -0.035912365    -0.21797913  0 1 0 1 0
     0.81142079     0.33997576     -1.3319419    0.029927015  0 0 1 1 0
    0.025431516    0.067446723    0.028925304     0.33807591  0 0 0 2 0
 -7.2130705e-16   2.395829e-15 -6.7074436e-16  2.8011489e-14  0 0 0 0 1
 -8.0344008e-16 -8.4204583e-15  4.6113261e-14 -7.7975922e-15  1 0 0 0 1
 -2.1963046e-16 -7.8606246e-16  2.4646817e-15 -1.0909688e-14  0 1 0 0 1
 -3.7147256e-16 -8.8648438e-16  6.0221692e-15  1.3425275e-14  0 0 1 0 1
 -3.3139766e-16 -5.5967834e-17 -3.8427815e-16 -9.6972098e-15  0 0 0 1 1
 -2.4792623e-16  2.7226815e-16 -1.3185506e-15 -8.6599971e-16  0 0 0 0 2

-------[ 2023-03-08 00:00:00 ] New Constraints for GEN4 kinematic

sbs.frontconstraintwidth_x = 1.0 # m
sbs.frontconstraintwidth_y = 0.3 # m

------[ 2023-09-01 00:00:00 ] # reverting to old constraint centering: 

sbs.frontconstraintwidth_x = 1.0 # m
sbs.frontconstraintwidth_y = 0.3 # m

sbs.backconstraintwidth_x = 0.22 # m
sbs.backconstraintwidth_y = 0.21 # m
sbs.backconstraint_x0 = 0.50286
sbs.backconstraint_y0 = 0.11554
sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

-------[ 2023-09-13 00:00:00 ]  #optics parameters for GEN4b kinematic

sbs.gemorigin_xyz =  -0.00102233   0.00070928      4.40
sbs.gemangles_xyz =     0.121055    -0.308798    -0.799353

sbs.optics_parameters =
  -0.0003513201  5.3757169e-05 0.00839405534      0.4462228  0 0 0 0 0
     0.27931137 -6.4786094e-05   0.0507172775    0.001446896  1 0 0 0 0
  0.00046508419 -0.00040215314   0.0014340977   0.0076777109  2 0 0 0 0
  0.00039824129  -0.0014993516       0.925907 -0.00018809634  0 1 0 0 0
     0.12583597   0.0093546922   -0.038057985   0.0032724021  1 1 0 0 0
   0.0050509875   0.0047190471   0.0093248106    0.038019853  0 2 0 0 0
    -0.49294892  0.00081299015  0.0056427729   -0.66939953  0 0 1 0 0
   0.0063149389   0.0020891526  -0.0060265101   0.0030162675  1 0 1 0 0
    -0.17285935   -0.040700375     0.16129629   -0.012315548  0 1 1 0 0
   -0.039082297    -0.00128007   -0.001709668    -2.0100546  0 0 2 0 0
  -0.0040627701      1.0170874     -4.8926068   -0.202228922  0 0 0 1 0
    -0.59575772   -0.049546309     0.21091191  -0.0056070761  1 0 0 1 0
   -0.025402411   -0.037685667   -0.035912365    -0.21797913  0 1 0 1 0
     0.81142079     0.33997576     -1.3319419    0.029927015  0 0 1 1 0
    0.025431516    0.067446723    0.028925304     0.33807591  0 0 0 2 0
 -7.2130705e-16   2.395829e-15 -6.7074436e-16  2.8011489e-14  0 0 0 0 1
 -8.0344008e-16 -8.4204583e-15  4.6113261e-14 -7.7975922e-15  1 0 0 0 1
 -2.1963046e-16 -7.8606246e-16  2.4646817e-15 -1.0909688e-14  0 1 0 0 1
 -3.7147256e-16 -8.8648438e-16  6.0221692e-15  1.3425275e-14  0 0 1 0 1
 -3.3139766e-16 -5.5967834e-17 -3.8427815e-16 -9.6972098e-15  0 0 0 1 1
 -2.4792623e-16  2.7226815e-16 -1.3185506e-15 -8.6599971e-16  0 0 0 0 2

-------[ 2023-11-01 00:00:00 ] # start pion-A_LL

sbs.backconstraint_x0 = 0.24
sbs.backconstraint_y0 = 0.0
sbs.backconstraintwidth_x = 0.25
sbs.backconstraintwidth_y = 0.22

-------[ 2024-04-01 00:00:00 ] # start GEN-RP

# according to the version of g4sbs used to generate this optics model, the first GEM plane is at 4.105 m
# from the target
sbs.optics_origin = 0.0 0.0 4.105 

# according to anecdotal, low-accuracy tape measurements from Sean and Anu and Bhashita et al,
# the GEN-RP GEM first layer was about 81 cm downstream of the back end of the SBS magnet iron in GEN,
# and in GEN-RP the first XW layer is about 5 cm downstream of THAT.
# so we estimate that the actual first GEN-RP GEM layer in Hall A is about 4.33 m from the target
# this is probably not a great guess! But anyway,
# for an initial guess at the ACTUAL position of the SBS GEMs in the hall, we go with:
#sbs.gemorigin_xyz = 0.0 0.0 4.329
#sbs.gemtheta = 0.0
#sbs.gemphi = 0.0

# AJRP 4/17/2024: Let's update these numbers from the survey report: according to the survey, the CE polarimeter fiducial point is
# 2.64 mm to beam left, 6.35 mm high, and 4.6 mm DOWNSTREAM of the "ideal" position which I assume is (0,0,4.760 m).
# assuming X/W layer 0,1 readout boards are symmetrically offset wrt the railing mount and 5.7 cm apart, then
# the first layer is essentially 0.428 m upstream of the fiducial point, which puts it at about 4.324 m 
# But wait! according to the survey, the magnet itself is also about 6.2 mm high and about 1.7 mm to beam left and about 1.2 mm upstream of ideal! so in fact,
# relative to the ideal optics coordinate system, the detector active area center is something like the following (to within a mm or so, not accounting for
# any mispointing or anything like that.
#sbs.gemorigin_xyz = 0.0 0.0 4.324
#sbs.gemtheta = 0.0
#sbs.gemphi = 0.0

# new GEM origin coordinates based on straight-through alignment, run 121:
# angles are given in degrees and positions in meters
#sbs.gemorigin_xyz =  -0.00644053   0.00102861      4.10979
#sbs.gemangles_xyz =     0.132415    -0.222712    -0.803711

# even better alignment after cutting the pathological region of track X
# where X/W strip offsets are wrong


#sbs.gemorigin_xyz =  -0.00510576   0.00075458      4.11962
#sbs.gemangles_xyz =     0.123051    -0.252785    -0.789754

#sbs.gemorigin_xyz =    -0.023448  -0.00823481      4.12017
#sbs.gemangles_xyz =   0.00168174  0.000662795    -0.788323

# after redefining transformation for SBS GEMs:

#sbs.gemorigin_xyz =  -0.00477348  0.000756327       4.1203
#sbs.gemangles_xyz =    -0.126063     0.259251    -0.789679

# after global alignment of the individual modules based on straight-through data:
sbs.gemorigin_xyz = 0 0 4.105
sbs.gemangles_xyz = 0 0 0

# after global alignment of the GEM stack, also based on straight-through data (not immediately obvious that this is somehow "better"):

sbs.gemorigin_xyz =   0.00295174  0.000299866      4.10704
sbs.gemangles_xyz =  -0.00627814    0.0419374   -0.0825597


# the following lines enable use of the "polarimeter mode" analysis:
sbs.polarimetermode = 1
# z of detector center line looks like it's more or less at the downstream edge of the analyzer, implying the downstream edge of the analyzer will
# about 0.428 m downstream of the X/W layer 0. Subtract half the analyzer thickness and we get that the center of the analyzer is about 39.7 cm
# downstream of the first GEM layer, which seems in the right ballpark.
sbs.z0analyzer = 0.397

# GEN-RP optics model (4th-order) from g4sbs for 100% SBS field, calculated using
# Bogdan's field map:

# second-order optics with scale factor 1.057
#sbs.optics_order = 2
#sbs.optics_parameters = 
# -0.00044566945  6.5794268e-05 -0.00050874088     0.46312392  0 0 0 0 0
#     0.35147022  1.8289173e-05   0.0023374836   0.0026402989  1 0 0 0 0
#    0.012753323   -0.025033924    0.058945784  -0.0094791369  2 0 0 0 0
#   0.0019919597   -0.010659333       1.043118   -0.041997392  0 1 0 0 0
#     0.24637582    0.078812488    -0.24130309    0.041567783  1 1 0 0 0
#    0.036264951    0.015637797    -0.08890566    -0.13110589  0 2 0 0 0
#    -0.44839794   0.0029572076   -0.014487956   -0.022950615  0 0 1 0 0
#   -0.038798016      0.1656326    -0.42691761    0.049163794  1 0 1 0 0
#    -0.29532316    -0.31008076      1.0498694    0.014030392  0 1 1 0 0
#   0.0033026169     -0.2009635      0.5588758   -0.030796712  0 0 2 0 0
#  -0.0018016593      1.0170495      -4.181738     0.04235215  0 0 0 1 0
#     -1.0686055    -0.14155181     0.40591013    0.079302969  1 0 0 1 0
#    -0.27693794    -0.18266314      1.0769671      1.0440456  0 1 0 1 0
#      1.3446902     0.61831487     -1.9383789    -0.26592363  0 0 1 1 0
#     0.65035381     0.33050366     -2.2399797     -2.0467629  0 0 0 2 0
# -2.4785282e-15  1.2040152e-16   -6.55716e-16  2.9832804e-14  0 0 0 0 1
#  1.2961777e-15  7.7302691e-16 -7.3717027e-15   4.982366e-15  1 0 0 0 1
# -2.3116124e-16  -5.355771e-17  3.2690256e-16  -5.065963e-16  0 1 0 0 1
#  2.8452203e-16 -1.9194794e-16 -9.6605917e-16 -4.6428789e-16  0 0 1 0 1
#  2.3776963e-16 -5.3153082e-17 -4.1940517e-16  9.7393625e-16  0 0 0 1 1
#  9.4869193e-16 -2.8608487e-16  3.7195019e-16 -8.2823428e-15  0 0 0 0 2

# scale factor 1.0657:
#sbs.optics_order = 4
#sbs.optics_parameters = 
#   0.0010177005  0.00024964849 -0.00031097503     0.45454816  0 0 0 0 0
#      0.3391492  -0.0049526251    0.010559986     0.12351254  1 0 0 0 0
#    0.046091804   -0.012017009    0.064368498     -0.4403885  2 0 0 0 0
#   -0.027695959   0.0099891219    -0.15317505     0.68211512  3 0 0 0 0
#    0.019745488   -0.078817125     0.24684153    -0.54554357  4 0 0 0 0
#  -0.0081825216   -0.025867113      1.0825375   -0.030775232  0 1 0 0 0
#     0.30914815     0.13090314    -0.37267959    -0.11611572  1 1 0 0 0
#   -0.036739767    -0.29817031     0.64395094     0.51439528  2 1 0 0 0
#   -0.014343899     0.26817023    -0.35219525    -0.62801878  3 1 0 0 0
#    0.023202964  -0.0066644483     0.25128292     -1.0551202  0 2 0 0 0
#     0.57299507     0.37454596     -2.7387595      5.5858217  1 2 0 0 0
#    -0.80448498     -1.0347856      3.1741826     -9.6062607  2 2 0 0 0
#       1.192227      6.4394595     -22.661387     0.66314112  0 3 0 0 0
#     -6.4523473     -3.3281207      14.195557      11.002638  1 3 0 0 0
#     -2.5737521     -2.4221441      4.1795523      48.624359  0 4 0 0 0
#    -0.40050454    0.019668726   -0.020374622    -0.48892425  0 0 1 0 0
#    -0.31869473    0.025841896    -0.32735255      3.1689086  1 0 1 0 0
#     0.51869525     0.15805913     0.35368936     -7.1779534  2 0 1 0 0
#     -0.2753925     0.69998804     -2.8470524      6.2118787  3 0 1 0 0
#    -0.53988538    -0.44835869      1.2748857    0.075821307  0 1 1 0 0
#     0.22765604      1.8850146     -4.7432255    -0.82076902  1 1 1 0 0
#     0.27737673     -3.3874808      6.3422424      8.6642903  2 1 1 0 0
#     -1.1866548     -0.7715963      6.2377672     -13.529308  0 2 1 0 0
#      5.8626145   -0.099210545     -7.6834026      53.416234  1 2 1 0 0
#      17.777632      13.637188     -47.506663     -22.351305  0 3 1 0 0
#     0.56002809     0.11037968     0.39192512     -5.8908252  0 0 2 0 0
#     -2.1669423     -1.0271779     0.20899356      24.799432  1 0 2 0 0
#      2.0888574     -1.0428373      6.6173306     -28.823198  2 0 2 0 0
#    -0.99955113     -3.0388136      7.9210973      -2.424297  0 1 2 0 0
#     -1.4930969      12.097552     -28.423229     -11.650359  1 1 2 0 0
#     -9.2895799      4.1680731    -0.88927817     -50.279842  0 2 2 0 0
#      2.8005463      1.7917946     -1.0688039     -29.542976  0 0 3 0 0
#     -5.6141763     -1.1444724     -4.4522178      61.774567  1 0 3 0 0
#     0.23341318     -13.715693      36.779773     -6.8470919  0 1 3 0 0
#      5.1710847      3.0544762      -1.086138     -51.891455  0 0 4 0 0
#    0.032079706      1.1083405     -4.4496717    0.027682064  0 0 0 1 0
#     -1.3044326    -0.56352346      1.6297942      0.4686618  1 0 0 1 0
#      0.3059865      1.4830926     -3.5705482     -3.2813702  2 0 0 1 0
#    -0.29249071    -0.81850291      1.0217073      6.9162263  3 0 0 1 0
#     -0.4282721    -0.14855057     -1.4862759      8.2901468  0 1 0 1 0
#     -1.9115285     -1.9964939      19.028193      -46.05086  1 1 0 1 0
#      2.8987854      8.5616114     -22.889604      82.321568  2 1 0 1 0
#      -11.36405     -77.840975      269.90387     -20.429192  0 2 0 1 0
#      72.487289      41.015629      -147.2979     -138.09366  1 2 0 1 0
#      23.167678      51.150139     -112.86162     -628.02386  0 3 0 1 0
#      2.3173376       1.948254     -5.6953753    -0.14215053  0 0 1 1 0
#      -2.267029     -9.8603115      27.648192      6.9308059  1 0 1 1 0
#      1.9192413      12.444003     -25.416593     -48.760728  2 0 1 1 0
#      1.0879082      1.4513052     -33.812957      110.08811  0 1 1 1 0
#     -25.808064      2.7630682      45.407132     -451.73127  1 1 1 1 0
#     -186.48696     -151.99771      475.35717      149.72862  0 2 1 1 0
#      6.2248928      16.879961     -49.823973      8.9444665  0 0 2 1 0
#      -4.857016       -48.1807      124.85153      66.850069  1 0 2 1 0
#      38.877481     -54.681569      90.051429      413.13662  0 1 2 1 0
#      10.150709      58.284195     -168.59666      20.905186  0 0 3 1 0
#      1.5022882      1.0217372       1.499968     -15.207546  0 0 0 2 0
#     -1.5276386     0.82503195     -30.939597      90.061219  1 0 0 2 0
#     0.63264171     -16.019485      38.586911     -164.34189  2 0 0 2 0
#      33.017792      311.87743     -1067.6798      126.91561  0 1 0 2 0
#     -274.47857     -157.23399      468.97589      544.15805  1 1 0 2 0
#     -69.365299      -373.7543      1029.0916      2890.2872  0 2 0 2 0
#       15.44296      12.472608      31.241934     -202.04511  0 0 1 2 0
#      7.8309262     -27.887941     -21.845915       885.3311  1 0 1 2 0
#      643.45471       519.7882     -1385.9566       -200.131  0 1 1 2 0
#      1.2806917      178.97175     -369.09485     -727.55631  0 0 2 2 0
#     -24.123873     -413.68411        1400.44     -205.42675  0 0 0 3 0
#      337.00374       190.3997     -435.28193      -773.6535  1 0 0 3 0
#      73.623476      1175.2115     -3830.0183     -5621.1943  0 1 0 3 0
#     -680.23604     -526.00883      1016.1465      50.135852  0 0 1 3 0
#      -16.28917      -1375.404      5035.2566       3793.016  0 0 0 4 0
#  5.5705426e-14 -1.6163269e-14 -4.1980998e-14  2.3939242e-13  0 0 0 0 1
#  7.9552485e-14  3.3793094e-13 -1.4300852e-12 -1.6426347e-12  1 0 0 0 1
# -1.0008026e-12  1.6216047e-12 -6.3052724e-12  9.4268144e-14  2 0 0 0 1
#  3.8663623e-14  1.0185602e-12 -3.4984732e-12 -5.5292783e-12  3 0 0 0 1
# -1.9248337e-13  1.7593366e-13 -8.7185744e-13  1.3383716e-12  0 1 0 0 1
#  6.3471057e-13 -5.7051847e-13  2.4923578e-12 -2.5642491e-12  1 1 0 0 1
# -5.0154665e-12  5.4290421e-12 -2.3174826e-11   1.981577e-11  2 1 0 0 1
#  -6.584765e-13 -9.2163126e-14 -3.4145946e-13  7.0490585e-12  0 2 0 0 1
# -1.8227662e-12  1.7462276e-12 -7.6103602e-12  7.1560606e-12  1 2 0 0 1
#  6.6543482e-14 -8.5315828e-14  5.0967453e-13  -7.233516e-13  0 3 0 0 1
# -3.5977759e-13  3.4141487e-13 -1.5690952e-12   2.244557e-12  0 0 1 0 1
#   4.322269e-13 -2.1024341e-13  1.2845949e-12 -6.4104354e-12  1 0 1 0 1
# -7.2704784e-13  2.6325079e-13 -1.5104753e-12  2.8602374e-12  2 0 1 0 1
# -8.7640342e-12  8.6322275e-12 -3.7626032e-11  3.7686852e-11  0 1 1 0 1
#  1.4629439e-12 -1.5644315e-12  6.7514511e-12 -7.6034547e-12  1 1 1 0 1
# -3.0403085e-14  1.0812031e-13 -4.6916127e-13 -2.9675566e-13  0 2 1 0 1
#  2.1612966e-13  2.3732711e-13  -5.465369e-13 -3.1097988e-12  0 0 2 0 1
# -7.0333087e-13  3.4972799e-13  -1.909002e-12  4.4706282e-12  1 0 2 0 1
#  3.1327345e-12 -2.9444068e-12  1.2926288e-11 -1.2412346e-11  0 1 2 0 1
# -5.3410559e-13  2.0730474e-15 -3.7291702e-13  2.2463711e-12  0 0 3 0 1
# -9.9847424e-13  7.1583971e-13 -3.3803115e-12  5.9358157e-12  0 0 0 1 1
#   1.247424e-14  2.7673549e-13 -1.0172086e-12 -9.5531451e-13  1 0 0 1 1
# -2.0134733e-12  2.0477448e-12 -8.8752164e-12   7.404162e-12  2 0 0 1 1
#  3.5153999e-12 -2.8999241e-12  1.3166371e-11 -1.7682997e-11  0 1 0 1 1
# -1.5704055e-12  1.6539072e-12 -7.2174814e-12  8.6493433e-12  1 1 0 1 1
#  1.2799485e-13 -9.7851195e-14   4.875157e-13 -2.2562113e-12  0 2 0 1 1
# -2.7989837e-12  2.9143887e-12  -1.247073e-11  1.1401115e-11  0 0 1 1 1
#  4.0435854e-13 -4.3505299e-13  1.9783009e-12 -5.4263362e-13  1 0 1 1 1
# -1.2920296e-13 -1.4494375e-13  3.5622091e-13 -1.4541177e-14  0 1 1 1 1
#  8.8224641e-13 -2.9852683e-13  1.6891311e-12 -6.0333967e-12  0 0 2 1 1
#  1.7551556e-12 -1.8583879e-12   7.993922e-12 -9.5503129e-12  0 0 0 2 1
# -1.0622019e-12  7.5265928e-13 -3.4602839e-12  3.8106682e-12  1 0 0 2 1
#  2.6442281e-14 -3.7658435e-13  1.3787404e-12  1.7111101e-13  0 1 0 2 1
#  1.1701544e-13  3.6213493e-13 -1.1557321e-12  -8.569712e-13  0 0 1 2 1
# -3.2862767e-14 -3.6822082e-14  1.2757998e-13 -1.5083316e-13  0 0 0 3 1
# -1.3104904e-13   2.544827e-13 -9.5042755e-13 -4.9321087e-13  0 0 0 0 2
#  1.6551226e-13  2.2565253e-13 -5.9873199e-13 -2.8550777e-12  1 0 0 0 2
# -1.0265468e-13 -1.8353704e-13  5.6251429e-13  9.6792675e-13  2 0 0 0 2
# -4.5678566e-12  4.2693826e-12 -1.8803763e-11  2.1683632e-11  0 1 0 0 2
#  3.1780546e-12 -3.0151209e-12  1.3294084e-11 -1.5778912e-11  1 1 0 0 2
# -3.1238604e-13  2.6460754e-13  -1.179659e-12  1.0947515e-12  0 2 0 0 2
# -6.3002311e-13  3.3714484e-14 -7.0455417e-13   3.267058e-12  0 0 1 0 2
# -1.4714565e-14 -1.0492571e-13  3.3994364e-13  4.1889713e-13  1 0 1 0 2
#  8.6482423e-13 -9.1169533e-13  3.9207027e-12 -3.0331645e-12  0 1 1 0 2
#  1.3793882e-13 -2.7606446e-13  1.0564248e-12 -8.1017204e-13  0 0 2 0 2
#  -1.327742e-12  1.0575197e-12 -4.7571301e-12  4.7679643e-12  0 0 0 1 2
#  7.1958903e-13 -8.9812474e-13  3.7434304e-12 -3.4382179e-12  1 0 0 1 2
#  5.2294862e-14  6.4527737e-14 -2.0249412e-13  4.5142152e-13  0 1 0 1 2
#  3.1109873e-13  8.2951115e-15  2.6990325e-13 -1.3336023e-12  0 0 1 1 2
#   3.538602e-13  6.1723289e-13 -1.8178964e-12 -1.3385882e-12  0 0 0 2 2
#  -1.186019e-13 -2.5043958e-13  7.6123485e-13  9.2798053e-13  0 0 0 0 3
#  8.7928911e-14  1.2008376e-13 -3.2166508e-13 -2.7959431e-13  1 0 0 0 3
#  5.9786478e-14  1.8939736e-13  -6.210738e-13 -4.4345054e-13  0 1 0 0 3
# -1.1507516e-14  1.4821672e-14 -5.2576202e-14 -9.7784521e-14  0 0 1 0 3
# -3.3121425e-14 -7.3784459e-14  2.2294523e-13  2.4354714e-13  0 0 0 1 3
#  2.1748405e-14  3.7176782e-14 -1.2975372e-13 -3.4784878e-16  0 0 0 0 4


## below are better 4th-order optics for scale factor 1
sbs.optics_order = 4
sbs.optics_parameters = 
0.00045184667  -0.0004145388   0.0012088257     0.43157173  0 0 0 0 0
     0.34959054   0.0013430912   -0.008840467     0.07380509  1 0 0 0 0
   -0.008126104   -0.020647109     0.08556774    -0.25578301  2 0 0 0 0
    0.049761787   -0.022584656    0.026872978     0.29100282  3 0 0 0 0
    0.040321501    -0.11862861     0.33519926   -0.031609736  4 0 0 0 0
   0.0010225251   0.0008415526     0.99040375   -0.034762329  0 1 0 0 0
     0.30101675   -0.059032509     0.25202106     0.15434936  1 1 0 0 0
    0.049113225    -0.11796849    0.074601559    -0.77302156  2 1 0 0 0
     -0.3379465     0.76168751     -1.6286282    -0.54406492  3 1 0 0 0
     0.15137046     0.12957021   -0.042447237     -1.7572917  0 2 0 0 0
    -0.75858297    -0.29196617    -0.64332067      6.9155909  1 2 0 0 0
     0.60235877      1.7946535     -5.1087565    -0.67090195  2 2 0 0 0
     -1.3264149      4.4263541     -16.519659      1.2558249  0 3 0 0 0
     -1.2707878     0.79040267      2.3783115     -7.6161457  1 3 0 0 0
      4.0891939     -3.8074549      8.6335805      2.7289535  0 4 0 0 0
    -0.43149036  -0.0034877192     0.02609711    -0.31265178  0 0 1 0 0
   -0.013231945     0.15200811    -0.60232102       1.923672  1 0 1 0 0
    -0.33389362     0.11123379     0.06544245     -3.2500029  2 0 1 0 0
   -0.035540924     0.66507995     -1.9824401      1.2375384  3 0 1 0 0
     -0.3827725     0.14072536    -0.80146121    -0.41642409  0 1 1 0 0
    -0.14682728   -0.042316794      2.2615289      1.2546374  1 1 1 0 0
      2.3459532     -4.4569224      8.1501834      2.0864811  2 1 1 0 0
      3.2706592      1.1276008      2.3397492     -25.495337  0 2 1 0 0
     -5.1278466     -7.1401826      10.359049      34.113469  1 2 1 0 0
     -5.6039415      15.077924     -62.765709      12.725216  0 3 1 0 0
     0.09433471    -0.18895822     0.86117915     -3.7707137  0 0 2 0 0
     0.47572633    -0.15476958    -0.83057813      12.687881  1 0 2 0 0
    -0.50090547     -1.0158011      3.6387701     -9.0190029  2 0 2 0 0
     0.19297042     0.89940523     -7.3273698     -1.5910675  0 1 2 0 0
      -5.627019      8.4304005     -10.806886     -4.4878397  1 1 2 0 0
      10.137656      6.2100681      6.8519619     -77.097116  0 2 2 0 0
    0.023868876     0.17210155       1.006818     -17.262854  0 0 3 0 0
      1.0794799     0.43285735     -3.4460118      24.871202  1 0 3 0 0
       4.458924     -5.3407299      1.0428316      2.1714762  0 1 3 0 0
    -0.51859088     0.30649774      1.2863561     -25.692695  0 0 4 0 0
   -0.002725769     0.99208506     -4.0521088    0.080858689  0 0 0 1 0
     -1.1840258     0.21400712    -0.99112233    -0.30491087  1 0 0 1 0
    -0.31795968     0.82254255     -1.1730264    0.060772523  2 0 0 1 0
      1.2901969     -3.0888259       6.898427      2.3329876  3 0 0 1 0
      -1.267561     -1.0712642     0.45087194      13.207823  0 1 0 1 0
      5.8716519      4.8051378     -1.1471229     -55.044171  1 1 0 1 0
     -3.2132627     -17.406466      45.690628      18.756041  2 1 0 1 0
      13.136827     -52.584869      199.73467     -18.701378  0 2 0 1 0
      20.213879     -2.0907909      -43.86539      68.061347  1 2 0 1 0
      -37.05901      49.228536     -123.78904     -6.3671889  0 3 0 1 0
      1.4768413    -0.62870616      3.4334896      1.0595629  0 0 1 1 0
      1.5287578     -1.9827417     -2.8365548      3.2496822  1 0 1 1 0
     -9.1589619      18.560804     -36.188838      -14.45193  2 0 1 1 0
     -24.885063     -15.807433     -1.8929055       204.8362  0 1 1 1 0
      29.275367      77.416042     -124.07181     -304.32258  1 1 1 1 0
      46.901834     -165.14431      696.82705     -161.97447  0 2 1 1 0
     -2.2000131    -0.46473289      17.319259     -1.8183561  0 0 2 1 0
      22.138967      -35.89432      52.889747      37.355437  1 0 2 1 0
     -64.647076     -89.452473      42.838295      634.26287  0 1 2 1 0
     -18.672648      23.008843     -15.016408     -27.046265  0 0 3 1 0
      2.6667459      2.3082789     -1.3632168     -25.496836  0 0 0 2 0
     -11.442152     -14.156684      13.858765      111.85699  1 0 0 2 0
      1.4999232      45.286107     -116.66453     -56.197044  2 0 0 2 0
     -43.609833       204.2327     -791.26354      100.61539  0 1 0 2 0
     -104.82601      16.243835      136.07921      -218.5068  1 1 0 2 0
      123.50813     -279.48469      784.01831     -55.899304  0 2 0 2 0
      47.297056       45.75002     -31.448629     -417.10535  0 0 1 2 0
     -33.219262     -216.50621       401.8736      664.58487  1 0 1 2 0
     -109.01358      485.27076     -2225.1285      739.52095  0 1 1 2 0
      95.271814      272.63641     -322.36124     -1308.0781  0 0 2 2 0
      46.974026      -260.0282      1028.7783     -168.19518  0 0 0 3 0
      175.20036     -69.055305     -21.307623      266.03493  1 0 0 3 0
     -187.93287      777.76022     -2369.9048      154.19659  0 1 0 3 0
      35.955693     -306.09734      1865.1879       -1152.17  0 0 1 3 0
      142.67004     -846.58122      2726.2582     -71.650461  0 0 0 4 0
  9.9368917e-14 -1.9785831e-13  9.6863008e-13  5.2659382e-13  0 0 0 0 1
 -1.5054527e-13  1.0800465e-13 -2.7439906e-13 -1.4068645e-13  1 0 0 0 1
  4.7532737e-13 -4.3291144e-13  1.4277126e-12  4.4540331e-13  2 0 0 0 1
  2.7182671e-13 -2.5688999e-13  7.9948545e-13  3.7097843e-13  3 0 0 0 1
  1.1153021e-12 -1.1584733e-12  3.1930467e-12  1.7623472e-12  0 1 0 0 1
  1.1629332e-12  -1.064811e-12  2.6681144e-12  1.5144192e-12  1 1 0 0 1
  2.5214898e-13 -2.6262798e-13  6.9578111e-13  3.2781076e-13  2 1 0 0 1
  7.2813294e-13 -7.7364968e-13  2.5367086e-12  1.1949677e-12  0 2 0 0 1
  1.8062494e-12 -1.5821543e-12  4.7139574e-12  1.0447914e-12  1 2 0 0 1
  4.7254324e-14 -1.5894971e-13  6.3905406e-13 -3.3482835e-13  0 3 0 0 1
 -2.7284484e-13  2.0536817e-13 -6.8989121e-13 -2.5355796e-13  0 0 1 0 1
  -2.222431e-12  2.0581245e-12 -6.1379767e-12 -2.4840409e-12  1 0 1 0 1
 -2.2624226e-12  2.0776471e-12 -6.4179878e-12 -2.0027493e-12  2 0 1 0 1
 -1.1716995e-13  1.6075073e-13 -6.1119603e-13 -2.6378759e-13  0 1 1 0 1
   5.100866e-13 -3.9367691e-13  1.3615725e-12  9.8306353e-14  1 1 1 0 1
  3.2049266e-13 -8.7401277e-14 -1.8736809e-13  4.1996315e-13  0 2 1 0 1
 -2.1841274e-12  2.0329232e-12 -6.3233513e-12 -1.6086146e-12  0 0 2 0 1
 -4.8233635e-13  3.1778344e-13 -6.0700997e-13  -6.576082e-13  1 0 2 0 1
  3.2131275e-13 -3.5093809e-13  1.1280023e-12  1.4441627e-13  0 1 2 0 1
  4.5739136e-13 -1.2261472e-13 -6.7767363e-14  9.8841959e-13  0 0 3 0 1
  -5.983201e-14   3.699588e-13 -2.0258452e-12  -9.007461e-13  0 0 0 1 1
  -5.074626e-13  5.3056407e-14  3.8824685e-13  4.5867033e-13  1 0 0 1 1
 -1.4854865e-12  1.4804061e-12 -4.5295479e-12 -1.1534004e-12  2 0 0 1 1
  2.4957985e-13 -2.4749292e-13  6.9469507e-13 -3.7585739e-13  0 1 0 1 1
  7.9748063e-14 -1.2788818e-13  3.1872543e-13  9.5350239e-13  1 1 0 1 1
  1.1207643e-13  2.0776439e-14 -6.2676021e-14 -2.2072339e-13  0 2 0 1 1
 -2.6412262e-14 -9.2923368e-14  6.1525286e-13  8.7290626e-13  0 0 1 1 1
  5.5407566e-13 -6.0541142e-13   1.786861e-12  6.3051463e-13  1 0 1 1 1
   4.017004e-14  6.6874216e-14 -1.3999239e-13  1.6934491e-13  0 1 1 1 1
   3.686102e-13 -3.0877373e-13  7.6504743e-13  2.7189859e-13  0 0 2 1 1
  -1.084948e-13  4.3384781e-13 -1.7308057e-12  6.7390154e-15  0 0 0 2 1
 -7.8534155e-14 -1.4289318e-13  8.9941921e-13 -5.4857799e-13  1 0 0 2 1
  9.5577355e-14 -2.8698511e-13  6.6001131e-13   2.524777e-13  0 1 0 2 1
  4.8075207e-14 -1.2320809e-13  4.2490846e-13  3.8779675e-14  0 0 1 2 1
  -2.665287e-14  3.8223609e-13 -1.2013111e-12 -6.7258478e-14  0 0 0 3 1
 -3.0920957e-12  2.8395023e-12 -8.5748212e-12 -2.8879949e-12  0 0 0 0 2
 -6.7904652e-12  6.4674942e-12 -1.9619317e-11 -6.8038843e-12  1 0 0 0 2
  1.3325991e-12 -1.1895498e-12  3.7696509e-12  8.6409976e-13  2 0 0 0 2
 -6.2187399e-13  3.9116644e-13 -9.4105835e-13  5.1932323e-14  0 1 0 0 2
 -2.9150434e-13  2.6582119e-13 -8.3223595e-13 -1.3526494e-13  1 1 0 0 2
 -1.4111185e-13 -9.8941166e-14  7.6372774e-13 -4.5099496e-13  0 2 0 0 2
  2.4126271e-13 -6.1449254e-13  2.3619337e-12  7.1576245e-13  0 0 1 0 2
  1.0764477e-12 -9.6531785e-13  2.8053682e-12  1.2162097e-12  1 0 1 0 2
 -1.4534706e-14  6.0982839e-14 -4.4229981e-13  3.8770135e-13  0 1 1 0 2
  8.4795815e-14 -3.9395912e-14  3.9296115e-13  -5.668718e-13  0 0 2 0 2
  -3.288785e-13  4.9654018e-13 -1.5044168e-12 -1.7974215e-13  0 0 0 1 2
 -2.8619067e-14 -8.8532237e-14  5.8680742e-13 -5.8962901e-13  1 0 0 1 2
 -3.5158598e-14  1.0799725e-13 -3.6320315e-13  4.4158967e-14  0 1 0 1 2
  2.1524613e-14 -1.0034293e-13  3.4351431e-13 -2.2657534e-14  0 0 1 1 2
 -3.9489354e-15 -7.9458185e-15  2.8418797e-14 -2.6469763e-14  0 0 0 2 2
  3.0095516e-14 -2.0272434e-13  6.4762459e-13  8.0648583e-14  0 0 0 0 3
 -3.5191723e-14   6.076569e-14 -2.6425526e-13  9.1275401e-14  1 0 0 0 3
  2.2746472e-15   7.724641e-15 -4.3231109e-14  2.3801465e-14  0 1 0 0 3
 -4.6620319e-15 -1.1024291e-14  1.8222656e-14  6.8205026e-15  0 0 1 0 3
 -1.8637492e-15  5.7939717e-15 -4.6668434e-14   3.391138e-14  0 0 0 1 3
 -6.6084819e-15  5.1200774e-14 -1.6992183e-13  4.8386199e-15  0 0 0 0 4





# these constraints should be okay to start with for "straight through" tracking with all SBS GEMs treated
# together as a single tracking unit

sbs.backconstraintwidth_x = 0.3
sbs.backconstraintwidth_y = 0.26
sbs.backconstraint_x0 = 0.0
sbs.backconstraint_y0 = 0.0


sbs.usedynamicconstraint = 1
# theta = xbcp * slope + th0
sbs.dynamicthslope = 0.111
sbs.dynamicth0 = -0.051

sbs.dynamicphslope = 0.111
sbs.dynamicph0 = 0.0

sbs.usedynamicconstraint = 1

sbs.polarimetermode = 0

sbs.frontconstraintwidth_x = 0.45
sbs.frontconstraintwidth_y = 0.15
sbs.frontconstraint_x0 = 0.2
sbs.frontconstraint_y0 = -0.012

------------[ 2024-04-18 23:51:00 ] # zero-field running, single foil. Target is front constraint:
sbs.dynamicth0 = 0.0
sbs.dynamicph0 = 0.0
# open these up a bit until we figure out how to center them for zero-field data:

sbs.dynamicphslope = 0.111
sbs.frontconstraintwidth_x = 0.10
sbs.frontconstraintwidth_y = 0.10

sbs.frontconstraint_x0 = 0.0
sbs.frontconstraint_y0 = 0.0

sbs.backconstraintwidth_x = 0.2
sbs.backconstraintwidth_y = 0.18

------------[ 2024-04-19 3:30:00 ] # back to full-field running
sbs.dynamicth0 = -0.051

sbs.frontconstraintwidth_x = 0.45
sbs.frontconstraintwidth_y = 0.15
sbs.frontconstraint_x0 = 0.2 
sbs.frontconstraint_y0 = 0.0


------------[ 2024-04-19 07:30:00 ] # analyzer installed

sbs.dynamicth0 = -0.06845

sbs.polarimetermode = 1

# the constraints to be used in "polarimeter mode" are below. Uncomment after the analyzer is installed

sbs.usedynamicconstraint = 0

sbs.backconstraintwidth_x = 0.006 0.3
sbs.backconstraintwidth_y = 0.006 0.26
sbs.backconstraint_x0 = 0.0 0.033
sbs.backconstraint_y0 = 0.0 0.0

# front constraint width should accommodate polar scattering angles up to
# about 18 degrees: 0.4 m * tan ( 18 deg ) ~= 0.13
sbs.frontconstraintwidth_x = 0.13 1.2
sbs.frontconstraintwidth_y = 0.13 0.3
sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0

----------[ 2024-05-15 16:00:00 ] # reduce sbs field setting to 70% of maximum

sbs.optics_order = 2

# new 4th-order optics for SBS 70% from g4sbs:
sbs.optics_parameters = 
-0.00037994301 -8.7224462e-05  0.00039198619     0.30507057  0 0 0 0 0
     0.35355175 -0.00068282719  0.00042214902    0.016411108  1 0 0 0 0
   0.0055787772   -0.024547906    0.065074306   -0.029975878  2 0 0 0 0
 -0.00023168979   -0.017126045      1.0664813   -0.056551997  0 1 0 0 0
     0.24823548     0.16362282    -0.57043755     0.17760195  1 1 0 0 0
    0.055226251     -0.1172221     0.53703751     0.60003635  0 2 0 0 0
    -0.45264014  0.00044755396   0.0051655066   -0.066463799  0 0 1 0 0
  -0.0016190805     0.15846078    -0.44789879     0.20301566  1 0 1 0 0
    -0.32663978    -0.68316196       2.452237    -0.38839627  0 1 1 0 0
   -0.034479702     -0.1955771     0.60672064    -0.32964641  0 0 2 0 0
  0.00087031185      1.0615179     -4.3423533     0.10297058  0 0 0 1 0
     -1.0315613    -0.56787469      2.0219423    -0.47910364  1 0 0 1 0
    -0.45292708     0.94101086     -4.2895418     -5.5620833  0 1 0 1 0
      1.3376506      2.4402697     -8.7395134       1.243135  0 0 1 1 0
     0.91244714     -2.0233656      9.0221837      12.721717  0 0 0 2 0
  3.1444523e-14 -1.6074834e-12  7.1956404e-12 -3.0290179e-13  0 0 0 0 1
  5.1493766e-14  1.9922388e-13 -9.1387833e-13 -8.1492549e-15  1 0 0 0 1
 -2.0781505e-17  1.3441747e-14 -5.3607027e-14  1.5751562e-15  0 1 0 0 1
  9.4695572e-15  1.3646665e-13 -6.1050445e-13  1.4055353e-14  0 0 1 0 1
  -4.511502e-16  7.4789263e-15 -1.7152007e-14  3.0419936e-16  0 0 0 1 1
  1.4586952e-15 -3.8415385e-15 -2.0766093e-15 -9.4585066e-15  0 0 0 0 2


---------[ 2024-05-15 16:39:00 ] # K_LL SBS 70% optics

sbs.optics_order = 4

sbs.optics_parameters =
 0.0021721586  6.4631629e-06  0.00016694556     0.29577734  0 0 0 0 0
     0.32439118  -0.0037803589   0.0058887419     0.15376342  1 0 0 0 0
     0.10958216   0.0032430767    0.015773959    -0.63978109  2 0 0 0 0
     -0.1643835    -0.07074742     0.14853006      0.9679387  3 0 0 0 0
     0.16533718   -0.084205208     0.25892367    -0.42362725  4 0 0 0 0
  0.00072532614  -0.0042513014      1.0074334  -0.0010419533  0 1 0 0 0
     0.28827044   -0.040956858     0.23182622    0.015965941  1 1 0 0 0
    0.062999839   -0.057176676    -0.29781624    -0.94179477  2 1 0 0 0
    -0.27346785     0.62804301     -1.0271934     0.83241387  3 1 0 0 0
    0.068184472    0.057055095    -0.16867074     -1.4754966  0 2 0 0 0
    -0.07678588     0.17663493     0.15183004      5.7390115  1 2 0 0 0
    -0.31598394     0.83679123     -4.4202278    -0.42192554  2 2 0 0 0
    -0.53696119      4.7562669     -17.300204      2.4510608  0 3 0 0 0
     -4.6384927     -1.9068859      10.626866     -7.0862786  1 3 0 0 0
     0.74305914     -1.9878536      1.3101151      21.065164  0 4 0 0 0
    -0.33415192   0.0091646372   -0.010423653    -0.63436265  0 0 1 0 0
    -0.91688057   0.0023026578    -0.17225839       5.151187  1 0 1 0 0
       2.180883     0.65610543     -1.2777016     -11.731668  2 0 1 0 0
     -2.1511222    0.088013253    -0.73023372       7.480661  3 0 1 0 0
    -0.34617797     0.12289544    -0.87461056      0.4130502  0 1 1 0 0
    -0.31258131   -0.064364022      3.7585767      1.9922875  1 1 1 0 0
      2.2199173     -4.7529577      6.7854471     -8.6863914  2 1 1 0 0
     0.51178222     0.23363371     -4.1893312     -23.894411  0 2 1 0 0
      2.0301948     -6.6056938      31.226692      23.914617  1 2 1 0 0
      2.5526573      8.2828143     -33.767523      22.885757  0 3 1 0 0
      1.8466152  -0.0083416764     0.29537216     -10.439068  0 0 2 0 0
     -9.2704262     -1.9249677      3.5181882       47.92231  1 0 2 0 0
      12.097982      2.3193101     -3.3826782     -47.730394  2 0 2 0 0
     0.44754234     0.63467116      -9.327202      1.3981041  0 1 2 0 0
     -5.9774041       12.38607     -13.787324      21.483057  1 1 2 0 0
     -5.2829154       11.75562     -57.862187     -74.982716  0 2 2 0 0
      12.616099      1.7612291     -3.1020874     -65.951756  0 0 3 0 0
     -31.515285     -7.0749787      11.886661      132.50751  1 0 3 0 0
       4.634812       -11.0269      5.9925178     -12.185949  0 1 3 0 0
      30.912435       5.811714     -9.7196082     -138.14806  0 0 4 0 0
  -0.0035670201      1.0298211     -4.1471808  -0.0052247585  0 0 0 1 0
     -1.1609518    0.059880757    -0.84752672    -0.35544774  1 0 0 1 0
    -0.21503562       0.723109     0.46105877       3.361661  2 0 0 1 0
     0.88882724     -2.6941819      4.2461858     -4.8465493  3 0 0 1 0
    -0.62859739    -0.42418125      1.5077955       11.08463  0 1 0 1 0
      1.3214054     0.15502373     -5.7800398     -45.091192  1 1 0 1 0
      2.4347785     -8.8764201      37.448883      10.575342  2 1 0 1 0
      5.2940213     -61.817537      217.29693     -23.482267  0 2 0 1 0
      51.832696      39.071959     -161.40311      51.093268  1 2 0 1 0
     -10.461559      35.851042     -106.35614     -188.18999  0 3 0 1 0
      1.3770155    -0.13510072      3.2369644   -0.040092232  0 0 1 1 0
      1.1748368     -3.3706792      -9.117935     -15.448813  1 0 1 1 0
      -6.875279      21.849044     -29.127765      49.156218  2 0 1 1 0
     -5.6642735     -5.5717657      47.303817      190.46913  0 1 1 1 0
     -18.249964      67.929977     -278.32007     -206.05743  1 1 1 1 0
     -27.544803     -147.75147      505.81445     -212.16801  0 2 1 1 0
     -2.0148587        4.11072      24.890082      15.358486  0 0 2 1 0
      17.495619     -61.441956      62.615347     -142.48705  1 0 2 1 0
      45.453908     -124.68438        557.331      609.66322  0 1 2 1 0
     -14.128788      60.147667     -34.969771      127.66045  0 0 3 1 0
      1.4204685     0.64399819      -2.922809     -21.799312  0 0 0 2 0
     -3.6534088     -1.7489977      17.563613      89.129257  1 0 0 2 0
     -6.5921921      24.563593      -91.21104     -27.825281  2 0 0 2 0
     -16.185784      262.58829      -900.4726      76.732675  0 1 0 2 0
     -205.29842     -182.20471      691.74568     -97.919663  1 1 0 2 0
      66.760287     -294.06528      1132.5029      740.43705  0 2 0 2 0
      12.407164      13.326215      -113.7404     -381.23325  0 0 1 2 0
      46.934318     -170.50224      657.26341      422.03264  1 0 1 2 0
      127.55756      646.58333     -2091.6754      661.59073  0 1 1 2 0
       -109.622      289.38933     -1284.1431     -1225.4834  0 0 2 2 0
      14.389835     -369.06604      1236.9548     -71.562779  0 0 0 3 0
      280.69705      246.35031     -905.83731     -1.6499715  1 0 0 3 0
      -172.4477      1100.9273     -4182.3814     -2166.1982  0 1 0 3 0
     -216.78473     -833.75205      2615.2593     -614.79451  0 0 1 3 0
      128.86488     -1490.8739      5089.0714      3540.7874  0 0 0 4 0
  6.9662577e-14 -9.3060939e-14  4.9395663e-13 -1.0804058e-12  0 0 0 0 1
 -1.9796954e-13 -1.2079506e-13 -4.6592768e-13  1.9461149e-12  1 0 0 0 1
  1.3496047e-13  1.1152235e-13  7.0280633e-13 -1.7514618e-12  2 0 0 0 1
  1.0018684e-14  1.5412166e-13  2.9035531e-13 -1.3409271e-12  3 0 0 0 1
 -1.2045938e-13 -8.2777059e-14  1.2474992e-13  2.8732584e-13  0 1 0 0 1
  3.2870416e-13  6.3149878e-14  5.9980965e-13 -1.1629512e-12  1 1 0 0 1
  1.4780371e-13 -9.4556713e-14 -1.4947672e-12  1.4268732e-12  2 1 0 0 1
 -3.3610803e-14 -1.2420843e-13  6.1987164e-13  2.4222715e-13  0 2 0 0 1
  5.1678621e-13  2.9340415e-13 -2.1697333e-12 -3.5814142e-13  1 2 0 0 1
  1.9500646e-13 -1.3030509e-13  2.5125711e-12 -1.9467933e-12  0 3 0 0 1
   3.243505e-13  7.3085101e-13   1.640928e-12 -6.2458387e-12  0 0 1 0 1
 -1.0264524e-12 -1.5737868e-12 -5.4220815e-12  1.5469212e-11  1 0 1 0 1
 -4.4464164e-13 -7.3645453e-13 -2.6585121e-12  8.8620211e-12  2 0 1 0 1
  -4.358502e-13  2.7083904e-13  1.8862289e-13 -1.6809185e-12  0 1 1 0 1
  1.1064779e-13 -3.5038159e-13  3.6999364e-12  -2.837931e-12  1 1 1 0 1
 -1.3661351e-12 -8.6426966e-14  4.6680847e-12 -9.2084327e-13  0 2 1 0 1
  2.4950302e-12  3.2715574e-12  1.3410912e-11 -3.3318892e-11  0 0 2 0 1
  9.5701456e-13  6.8357994e-13  5.3161537e-12 -1.0101958e-11  1 0 2 0 1
 -3.2998393e-13 -5.9258193e-13  2.4652996e-12  1.5237761e-12  0 1 2 0 1
 -1.1125506e-13  3.8123781e-14 -3.5838987e-13  9.0254623e-13  0 0 3 0 1
  -5.058679e-14  1.9005652e-13 -5.7384313e-13 -4.9962689e-13  0 0 0 1 1
 -5.7575121e-13 -4.7743305e-13 -4.9224212e-13  3.2760934e-12  1 0 0 1 1
 -3.7493166e-13  5.8379392e-13   3.076194e-12 -4.9056455e-12  2 0 0 1 1
   -3.58647e-13 -1.3921292e-14 -1.4205821e-12  2.7048008e-12  0 1 0 1 1
 -3.0645079e-13 -1.7200493e-13  2.8358251e-12 -1.9465439e-12  1 1 0 1 1
 -3.0129063e-13 -6.9706984e-13 -1.1345276e-12  5.7397043e-12  0 2 0 1 1
 -3.4149636e-13 -9.3470459e-13 -3.4571689e-12  9.2529714e-12  0 0 1 1 1
  4.7342891e-13  7.5629448e-13 -1.4006898e-12 -2.8257018e-12  1 0 1 1 1
  -6.768239e-13 -1.1238389e-13  5.2336396e-12 -2.7256571e-12  0 1 1 1 1
 -9.2816576e-14  2.7048053e-13   -2.45962e-12  6.8714625e-13  0 0 2 1 1
 -3.8541704e-13 -6.5929996e-14 -6.2557076e-13    1.92171e-12  0 0 0 2 1
 -4.1519946e-14 -2.2108822e-13   2.364711e-12  1.2516045e-13  1 0 0 2 1
 -5.2828011e-14 -3.2177135e-13 -1.3364182e-12  2.7720195e-12  0 1 0 2 1
 -4.0349234e-13  8.4469975e-13 -7.2812434e-13 -4.2838616e-12  0 0 1 2 1
 -1.3670018e-13  3.0065564e-13 -2.1959504e-12 -1.5455585e-13  0 0 0 3 1
  2.7404378e-13  4.0951313e-13 -8.6711032e-14 -2.3017653e-12  0 0 0 0 2
 -1.8415275e-13 -4.0376173e-13 -2.6002871e-12  4.5469718e-12  1 0 0 0 2
 -6.2575942e-14 -5.1622496e-13 -1.6308504e-13  3.8290621e-12  2 0 0 0 2
  1.0383472e-13 -7.3492849e-14 -1.9417849e-12  1.6407792e-12  0 1 0 0 2
  6.5526961e-13  5.9083248e-13 -1.8954968e-13 -4.2647717e-12  1 1 0 0 2
 -7.1011474e-13 -1.8294862e-13  9.6202772e-13     1.7461e-12  0 2 0 0 2
   1.390572e-12  2.1050292e-12  2.3990275e-12 -1.6133943e-11  0 0 1 0 2
 -7.2618029e-14  7.1705996e-14  4.3642969e-13 -8.2339862e-13  1 0 1 0 2
 -4.9136861e-13 -1.1314651e-13  6.3194245e-12 -4.1065923e-12  0 1 1 0 2
 -3.2513694e-13 -6.2379591e-13 -1.2525174e-12  5.5032576e-12  0 0 2 0 2
 -1.5900366e-13  2.7232025e-13 -1.6315698e-12  2.5719699e-13  0 0 0 1 2
  3.1944168e-13  -2.928303e-14 -1.2575202e-13  4.9163372e-13  1 0 0 1 2
 -6.5284115e-14 -3.7729797e-13  1.2619374e-12  1.1555872e-12  0 1 0 1 2
 -2.6607582e-14  2.0179128e-13  7.6013202e-13 -1.0220869e-12  0 0 1 1 2
 -2.1644548e-15  -1.992454e-14 -6.9254735e-14  1.9101452e-13  0 0 0 2 2
 -9.6316982e-14  4.9593711e-14 -1.3223801e-14  -8.791981e-13  0 0 0 0 3
 -4.1225978e-14 -9.6678849e-14  7.1412913e-13 -2.2775134e-13  1 0 0 0 3
 -1.7889921e-15 -1.6470006e-14  1.9487738e-14 -3.7206398e-14  0 1 0 0 3
 -6.1853924e-14 -4.8528692e-14  1.6113397e-13 -2.0950645e-13  0 0 1 0 3
 -5.2478501e-15  1.0790091e-14 -4.8598342e-14 -4.3619251e-14  0 0 0 1 3
   7.517595e-15  4.8219678e-15 -6.4889972e-14  1.6334801e-14  0 0 0 0 4

---------[ 2024-05-16 22:42:00 ] # K_LL SBS 72% optics

sbs.optics_order = 4

sbs.optics_parameters =
 0.00094485125  -0.0014155471   0.0046720285     0.30636342  0 0 0 0 0
     0.34002907    0.015646817   -0.052464889     0.11997503  1 0 0 0 0
    0.037944368   -0.081620437     0.25648984    -0.45006993  2 0 0 0 0
   -0.024596844    0.090174492    -0.25385218     0.56455242  3 0 0 0 0
    0.066953973    -0.20174263      0.5089296    -0.13188186  4 0 0 0 0
   -0.013959417  -0.0077383046      1.0146848   -0.020967686  0 1 0 0 0
       0.402988   -0.017111244     0.13718493     0.27349639  1 1 0 0 0
    -0.16902748   -0.094745443      0.1346082     -1.6174452  2 1 0 0 0
    -0.21827871     0.62230505     -1.7353425      1.0587507  3 1 0 0 0
     0.14076484    0.076906642    -0.16601055     -1.1207493  0 2 0 0 0
    -0.17087175    -0.58040197      1.8763286      4.5193193  1 2 0 0 0
    -0.21162753      2.2273703     -9.6648859     -1.5666545  2 2 0 0 0
   -0.036940491      4.1675644     -15.904498     0.65285246  0 3 0 0 0
      -3.316228     0.12303439      6.4152339     -9.0015765  1 3 0 0 0
    -0.89784292     -3.5728164      12.176454      25.945092  0 4 0 0 0
    -0.39596391   -0.065904014     0.21848096     -0.5056272  0 0 1 0 0
    -0.36518438     0.65119046     -2.0585725      3.7232276  1 0 1 0 0
     0.56819497     -1.1426446      3.4107763     -7.2879209  2 0 1 0 0
    -0.62230888      1.7774243     -4.5064389      3.2663301  3 0 1 0 0
     -0.8527161    0.026164323    -0.54228164    -0.69867362  0 1 1 0 0
      1.8373902     0.10626376       1.409472      8.1790531  1 1 1 0 0
      1.0061274     -4.7250531      13.510914     -14.843254  2 1 1 0 0
      2.0526701      2.6631613      -8.841566     -17.508986  0 2 1 0 0
    0.076576432     -16.941507      66.320675      19.832393  1 2 1 0 0
      6.3165386      11.450946     -58.846473      10.646163  0 3 1 0 0
     0.78474687      -1.249892      3.9877663     -7.7132109  0 0 2 0 0
     -3.1163115      4.8131514     -14.769451      31.375663  1 0 2 0 0
       3.335602     -6.8262821       18.20951     -24.783364  2 0 2 0 0
     -4.3400396     0.62124294     -6.7863276      -12.53115  0 1 2 0 0
     0.95801087      12.291404     -33.985655      54.507232  1 1 2 0 0
      3.6917886      29.233495     -109.95815     -44.855885  0 2 2 0 0
       4.831644     -6.6922596      20.683507     -44.907755  0 0 3 0 0
      -9.415407      15.162033     -43.642599      76.490242  1 0 3 0 0
      -6.892494     -10.440374      24.467247     -61.877133  0 1 3 0 0
       10.14166     -14.688007      44.085326     -85.582251  0 0 4 0 0
    0.059921639      1.0394691      -4.185377    0.074906159  0 0 0 1 0
     -1.6742663    0.025809356    -0.43553866     -1.2081402  1 0 0 1 0
     0.81004213     0.61348726     -1.3858315      5.5606919  2 0 0 1 0
     0.70602374     -2.3853912      7.4304407     -5.4970716  3 0 0 1 0
     -1.1696531    -0.48383355     0.93602544        8.44708  0 1 0 1 0
      1.4597453      5.7549157     -18.048987     -37.502474  1 1 0 1 0
      3.3624733     -18.523272      78.191251      21.376975  2 1 0 1 0
      2.1196294     -56.665436      211.03016     -10.207763  0 2 0 1 0
      31.773588       25.99927      -139.9928      88.426455  1 2 0 1 0
      7.5232751      44.055195      -158.9004     -211.34544  0 3 0 1 0
      3.6555248   -0.011724759      1.9216391      3.6676711  0 0 1 1 0
     -8.4654656     -2.0825045     0.73668882     -35.600084  1 0 1 1 0
     -1.9583276       18.42976     -58.861508      69.665027  2 0 1 1 0
     -16.189901     -23.893386      77.065433      148.38476  0 1 1 1 0
     -13.180706      142.26003     -546.90734     -184.60744  1 1 1 1 0
     -47.616038     -211.02967      870.84358      -148.5496  0 2 1 1 0
      19.813134     0.25748908      14.785278      59.948638  0 0 2 1 0
     -12.526797     -48.701755      151.60285     -253.43623  1 0 2 1 0
     -13.437575     -252.50282      935.52885      386.90688  0 1 2 1 0
      37.722786      41.942381     -116.33947      290.25349  0 0 3 1 0
        2.58854     0.75082135     -1.2998301      -16.83353  0 0 0 2 0
     -3.9852683     -13.933841      42.590173      77.835496  1 0 0 2 0
     -10.258067      44.129962     -176.25303     -51.670924  2 0 0 2 0
      -15.85221      253.02776     -925.46145      55.800799  0 1 0 2 0
     -103.85602     -191.92058       771.3718      -283.4451  1 1 0 2 0
     -2.3973766     -222.48986      834.61456      449.79839  0 2 0 2 0
      35.300543       54.78545     -172.21929     -312.16024  0 0 1 2 0
      43.694208      -327.7116      1216.8188      397.55644  1 0 1 2 0
       86.10583      1064.3242     -3983.6611      672.70607  0 1 1 2 0
      11.408028      567.91267     -2051.4196     -802.08704  0 0 2 2 0
      32.407163      -373.6005      1346.8462     -91.935918  0 0 0 3 0
      106.59001      356.77753     -1294.1697      272.28655  1 0 0 3 0
     -55.533672      528.44445     -2040.9437      3.6677318  0 1 0 3 0
      43.836565     -1661.7781      5915.1828     -960.58299  0 0 1 3 0
      55.645873     -471.37915        1909.31     -264.17845  0 0 0 4 0
 -2.9265344e-13  4.2624899e-13 -1.6657015e-12  1.8002993e-13  0 0 0 0 1
  6.5301016e-13 -2.1615611e-12  8.1275832e-12 -7.8121391e-13  1 0 0 0 1
 -5.6284081e-13  3.7758802e-13 -1.0889766e-12  -1.270451e-14  2 0 0 0 1
 -2.7053343e-12  3.4271623e-12 -1.1822566e-11   3.530288e-12  3 0 0 0 1
 -1.2799306e-12  5.4386163e-12 -2.0667015e-11   2.732396e-12  0 1 0 0 1
 -2.5556089e-12  1.9028678e-12 -5.9303304e-12  2.6769938e-12  1 1 0 0 1
  7.8738941e-13 -1.2538652e-11  4.8896486e-11   -4.57523e-12  2 1 0 0 1
  1.7405534e-12   1.202924e-12 -5.7810093e-12 -9.6334766e-13  0 2 0 0 1
  1.4736436e-12   4.115537e-11 -1.6317312e-10  1.2159762e-11  1 2 0 0 1
  3.7154991e-13 -1.4422904e-12  5.4686288e-12 -5.0458832e-13  0 3 0 0 1
 -2.5090216e-12  7.2336935e-12 -2.6931057e-11  4.1506298e-12  0 0 1 0 1
  3.9503927e-12 -4.8217319e-12  1.6559089e-11 -4.5793029e-12  1 0 1 0 1
  1.0357403e-11 -1.6393749e-11  5.8292752e-11 -1.3024007e-11  2 0 1 0 1
  5.3061445e-12 -1.2407651e-11  4.5638612e-11 -7.8903725e-12  0 1 1 0 1
  -2.123246e-13 -9.5241484e-13  3.9652817e-12 -3.3535274e-13  1 1 1 0 1
   4.984796e-13  1.0267235e-11 -4.0831821e-11  2.5918589e-12  0 2 1 0 1
  3.1997606e-12 -5.2167651e-12  1.8670729e-11 -4.3415819e-12  0 0 2 0 1
  4.4869501e-12 -7.6371368e-12  2.7327148e-11 -5.5709015e-12  1 0 2 0 1
 -9.2643496e-13  2.3890069e-12 -8.7666826e-12  1.4370334e-12  0 1 2 0 1
  1.0409294e-12 -1.5863331e-12  5.5375876e-12 -1.3328713e-12  0 0 3 0 1
  7.5675563e-12 -1.4388509e-11  5.2077182e-11 -1.0225104e-11  0 0 0 1 1
  3.9880911e-12 -1.9219406e-12  5.0948436e-12 -3.4873009e-12  1 0 0 1 1
 -5.3491337e-12  3.6844619e-12 -1.1179799e-11  5.4392758e-12  2 0 0 1 1
 -7.0915653e-12  1.0908526e-11 -3.8699948e-11  8.8778853e-12  0 1 0 1 1
 -6.7629754e-12  1.8927523e-11 -7.0404247e-11  1.0998623e-11  1 1 0 1 1
 -9.4377339e-13  2.3802388e-12  -8.694193e-12  1.2119657e-12  0 2 0 1 1
  2.2836839e-12 -2.0359061e-12  6.6229994e-12 -2.5793915e-12  0 0 1 1 1
 -2.6471899e-12  2.7140824e-12 -9.1946585e-12   3.133146e-12  1 0 1 1 1
 -1.6140449e-12  4.7371306e-12 -1.7678813e-11  2.6225117e-12  0 1 1 1 1
 -1.1743931e-12  1.8854699e-12 -6.6788486e-12  1.5471714e-12  0 0 2 1 1
 -3.6300977e-12   5.870801e-12  -2.081166e-11  4.3893642e-12  0 0 0 2 1
 -3.2996052e-12  6.6312844e-12 -2.4178879e-11  4.9361228e-12  1 0 0 2 1
 -4.5101333e-13  9.0268547e-13 -3.3147973e-12  7.7275436e-13  0 1 0 2 1
 -7.9639278e-13  1.4640068e-12 -5.3296963e-12  1.1874512e-12  0 0 1 2 1
 -1.9381244e-13  9.6440807e-13 -3.5721483e-12  4.5209287e-13  0 0 0 3 1
  4.1991065e-12  1.0378575e-12 -6.6693712e-12 -2.8588315e-12  0 0 0 0 2
 -9.2465416e-12  1.1074112e-11 -3.8012307e-11   1.055774e-11  1 0 0 0 2
 -3.0382843e-11  4.5827372e-11 -1.6203046e-10  3.7703282e-11  2 0 0 0 2
 -1.6482996e-11  1.8399216e-11 -6.2422633e-11  1.8359099e-11  0 1 0 0 2
 -7.5824776e-12  6.7754246e-12 -2.2073933e-11  8.0958189e-12  1 1 0 0 2
 -2.4306831e-12 -3.0407733e-13  2.7124374e-12  1.4186144e-12  0 2 0 0 2
 -4.4119913e-12  6.5688178e-12  -2.312286e-11  5.2659288e-12  0 0 1 0 2
  -8.026986e-12  1.2563493e-11 -4.4566118e-11  1.0166264e-11  1 0 1 0 2
 -7.5176572e-13  5.1164039e-13 -1.4708908e-12  7.5611895e-13  0 1 1 0 2
 -1.9011373e-12  3.0169774e-12 -1.0710128e-11  2.2245301e-12  0 0 2 0 2
 -3.9374266e-12  4.2882565e-12 -1.4456166e-11  4.6049404e-12  0 0 0 1 2
 -1.9156954e-12  1.8613081e-12 -6.1676269e-12  2.0838517e-12  1 0 0 1 2
 -5.9838614e-13  2.3884927e-13 -4.8861873e-13  6.0422546e-13  0 1 0 1 2
 -2.1738309e-13  4.7395868e-13  -1.635413e-12  3.3171582e-13  0 0 1 1 2
 -1.7558592e-13  1.3750268e-13 -4.3240813e-13 -3.8311826e-14  0 0 0 2 2
 -1.9612358e-14  9.4654193e-14 -3.5856953e-13  5.7427764e-14  0 0 0 0 3
  4.2098578e-14 -7.7748429e-14  3.0516478e-13  1.6089043e-13  1 0 0 0 3
  3.1281335e-14  4.2585516e-13 -1.5605082e-12  2.4493752e-13  0 1 0 0 3
  1.4070237e-14 -1.9261122e-13  7.0129616e-13  -8.241166e-14  0 0 1 0 3
  2.7117036e-15  2.8137268e-14 -9.7908908e-14  9.7829081e-15  0 0 0 1 3
  -2.177123e-14 -6.6004755e-14  2.4184395e-13 -3.2394188e-14  0 0 0 0 4



---------[ 2024-05-17 12:09:00 ] # K_LL SBS 65% optics

sbs.optics_order = 4

sbs.optics_parameters =
 0.00094182488  0.00087554388   -0.003398353     0.27310246  0 0 0 0 0
     0.33959782   -0.016837885    0.061913995     0.15775009  1 0 0 0 0
    0.044274243    0.073845003    -0.27293702    -0.61343563  2 0 0 0 0
   -0.035798107    -0.22407027     0.75852169      0.8245645  3 0 0 0 0
    0.066591189    0.035674157    -0.21217059    -0.27782283  4 0 0 0 0
   0.0065808472    -0.00296846      1.0120613   -0.012229231  0 1 0 0 0
     0.19227086   -0.020964516     0.10902641      0.3209799  1 1 0 0 0
     0.45976563    0.012784059    -0.42445937     -2.5200584  2 1 0 0 0
    -0.90420176     0.45715924    -0.49197048         3.4124  3 1 0 0 0
     0.11014668    0.035461637    -0.13410844    -0.19949724  0 2 0 0 0
    -0.55952368     0.54071593     -2.4913973     -4.6442546  1 2 0 0 0
   -0.048126179    -0.95544336      4.3827611      20.317307  2 2 0 0 0
    0.020651023      3.1838473     -12.231904     -3.2890214  0 3 0 0 0
     -3.1450142     -4.0487173      18.059984      12.674784  1 3 0 0 0
      3.0230581     -2.1412747      5.8567621      12.219087  0 4 0 0 0
    -0.39336638    0.057320781     -0.2227509    -0.64262457  0 0 1 0 0
    -0.40321476    -0.52296435      2.0010201      4.9314516  1 0 1 0 0
     0.65900761      2.3858224     -8.2255854     -10.313456  2 0 1 0 0
    -0.62939105     -1.7161135      6.4811045      5.6224045  3 0 1 0 0
   -0.020101303    0.054706889    -0.29279225    -0.85467177  0 1 1 0 0
     -3.1082868    -0.30081267       3.033818      13.538608  1 1 1 0 0
      8.4572223     -3.7234597      3.9853767     -33.675555  2 1 1 0 0
      2.6524781    -0.68915979      5.2694487      16.089972  0 2 1 0 0
    -0.74738784      2.1875177     -21.553672     -115.43088  1 2 1 0 0
      1.4698487      7.2059983     -37.802711     -36.589845  0 3 1 0 0
     0.85529679     0.95096136     -3.7684347     -9.9698324  0 0 2 0 0
     -3.3526515     -8.3448454      29.633675      43.029573  1 0 2 0 0
      3.2439579      12.517322     -44.415107     -38.850091  2 0 2 0 0
      5.4035209     0.58780574     -4.7613166     -20.288728  0 1 2 0 0
     -26.697422      10.963011     -15.144021      107.18633  1 1 2 0 0
      1.3300212    -0.24716434      33.129198      189.10626  0 2 2 0 0
      5.0622296      9.5681232     -35.493198     -59.932709  0 0 3 0 0
     -8.8078599     -32.285369      114.18341      113.46399  1 0 3 0 0
      28.022034      -11.97858      23.051061     -113.43327  0 1 3 0 0
      9.3689061      28.696634     -104.10868     -122.18175  0 0 4 0 0
    -0.03130136      1.0200018     -4.1632982    0.085681507  0 0 0 1 0
    -0.72776512    0.027253992    -0.37818472     -1.7967433  1 0 0 1 0
     -2.0196282     0.21564891      1.1229036        10.0485  2 0 0 1 0
      3.7023486     -1.6961557      1.7470555     -15.644016  3 0 0 1 0
    -0.86707721    -0.12369159     0.50533004     0.44398189  0 1 0 1 0
      4.2287029     -4.1627153      20.975777      41.313817  1 1 0 1 0
      1.5221224      9.7383405     -46.294674     -162.37564  2 1 0 1 0
     0.54394462     -41.552755       153.5612      19.289224  0 2 0 1 0
       27.51118      65.700057     -247.39798     -71.513487  1 2 0 1 0
     -23.985179      10.984435     -19.005183     -73.798667  0 3 0 1 0
   -0.085890695   -0.042280786      1.0031586      5.5576318  0 0 1 1 0
      13.705251    -0.83760051      -6.721774     -62.978729  1 0 1 1 0
      -34.52001      14.622834     -16.113422      154.61745  2 0 1 1 0
     -18.631249      5.9227741     -48.982482     -143.51387  0 1 1 1 0
     -7.0553669     -28.312261      235.07424      965.74745  1 1 1 1 0
      11.432832      -130.1805       520.5138      147.99374  0 2 1 1 0
     -23.682511      1.3315661      6.8030839      102.63532  0 0 2 1 0
      108.64962     -45.772048      68.176124     -501.81946  1 0 2 1 0
      15.646689      10.250291     -335.67906     -1617.2449  0 1 2 1 0
     -115.25668      52.576081     -109.78074      545.83205  0 0 3 1 0
      1.7893218    -0.14542453     0.33674332     0.94837746  0 0 0 2 0
     -9.0717584      9.4193067     -49.325902     -93.226076  1 0 0 2 0
     -4.7337627     -20.864901      106.64837      335.67813  2 0 0 2 0
     -6.6389814       179.4219     -642.07398      13.575199  0 1 0 2 0
     -68.468597     -314.13391      1080.5457     -75.318977  1 1 0 2 0
      74.411079       1.249829     -89.232293     -34.931022  0 2 0 2 0
      36.014741     -17.036395      129.15134       326.4934  0 0 1 2 0
      28.747434      70.983527     -580.96775     -2067.6536  1 0 1 2 0
     -168.33198      637.81709     -2212.9566      659.90374  0 1 1 2 0
     -62.961886      -52.28861        888.043      3523.2599  0 0 2 2 0
      16.356197     -259.63984      899.08379     -145.47625  0 0 0 3 0
      28.914436      484.46122     -1555.3096      640.86644  1 0 0 3 0
     -156.98902     -37.317733      265.41719      860.58055  0 1 0 3 0
      409.15747     -1008.6587      3105.6706     -2678.8512  0 0 1 3 0
      236.35257     -53.948652      188.83468     -1211.7679  0 0 0 4 0
  2.2744207e-13  6.3138555e-13 -1.9855253e-12 -6.4217554e-14  0 0 0 0 1
 -8.0717083e-13   -4.30619e-12  1.2841034e-11  1.2564589e-13  1 0 0 0 1
  4.4763664e-13  1.9669861e-12 -5.8099348e-12 -8.6188033e-14  2 0 0 0 1
  2.8032226e-12  1.4793217e-11 -4.4467281e-11 -1.6029785e-12  3 0 0 0 1
  2.7521724e-12  1.5234263e-11 -4.5671596e-11 -4.2364359e-12  0 1 0 0 1
 -5.6477659e-12 -2.9410382e-11  8.8728168e-11   1.415641e-12  1 1 0 0 1
 -1.2845398e-12 -6.7721524e-12  2.0368246e-11  5.7933968e-13  2 1 0 0 1
    1.91188e-12  1.0101749e-11 -3.0408132e-11 -1.4589469e-12  0 2 0 0 1
 -1.1842215e-12 -6.4368986e-12  1.9401574e-11  1.0951569e-12  1 2 0 0 1
  2.4257347e-12  1.3284361e-11  -4.010268e-11 -1.6799148e-12  0 3 0 0 1
  3.3457359e-12  1.7354283e-11 -5.1844254e-11  -1.885914e-12  0 0 1 0 1
 -4.2335685e-12 -2.1328987e-11  6.3178467e-11  1.6294337e-12  1 0 1 0 1
 -1.0794179e-11 -5.6967254e-11  1.7094729e-10  7.1052038e-12  2 0 1 0 1
  2.1780388e-11  1.1580325e-10 -3.4843946e-10 -1.6340843e-11  0 1 1 0 1
 -2.3305813e-12 -1.2719218e-11  3.8298232e-11  1.3780186e-12  1 1 1 0 1
  -1.069832e-12 -5.2157818e-12  1.5531095e-11  8.1238399e-13  0 2 1 0 1
 -9.4032439e-13 -7.3529077e-12  2.4388058e-11  4.1580293e-12  0 0 2 0 1
 -4.5263622e-12 -2.5071074e-11  7.6178486e-11  4.0676383e-12  1 0 2 0 1
 -4.3317905e-12 -2.2671503e-11   6.799922e-11  2.4221969e-12  0 1 2 0 1
 -1.9243124e-12 -9.2464418e-12  2.7985972e-11  2.8978582e-12  0 0 3 0 1
 -6.0923138e-12 -3.2234787e-11  9.6960799e-11  3.4807046e-12  0 0 0 1 1
 -4.8450971e-13 -2.0287232e-12  6.1659263e-12  4.0317017e-13  1 0 0 1 1
  5.5568475e-12  2.9350217e-11 -8.8263976e-11 -3.9073568e-12  2 0 0 1 1
 -9.2829012e-12 -4.9190675e-11  1.4804761e-10  7.0362755e-12  0 1 0 1 1
 -2.1858065e-11 -1.1612989e-10  3.4945693e-10  1.5600925e-11  1 1 0 1 1
 -1.3083336e-12  -7.247074e-12  2.1988325e-11  8.6499943e-13  0 2 0 1 1
 -2.0794392e-13 -7.1722181e-13  1.9632856e-12  1.3483721e-13  0 0 1 1 1
  8.3973042e-13  5.0560908e-12 -1.5073762e-11  5.1771754e-13  1 0 1 1 1
 -6.5381435e-12 -3.5390601e-11    1.06685e-10  4.8043238e-12  0 1 1 1 1
  3.3567465e-13  1.0526286e-12  -3.216869e-12 -8.2618723e-13  0 0 2 1 1
 -4.4455145e-12 -2.3418958e-11  7.0462029e-11  3.6351022e-12  0 0 0 2 1
 -1.0141761e-11  -5.453523e-11    1.64016e-10  6.7637959e-12  1 0 0 2 1
 -9.9248599e-13 -4.9694875e-12  1.5019644e-11   9.511878e-13  0 1 0 2 1
 -3.2174022e-12 -1.6236784e-11  4.8822377e-11  2.4789302e-12  0 0 1 2 1
 -2.6740689e-13 -2.3146443e-12  7.0788251e-12 -1.4049697e-13  0 0 0 3 1
 -1.3378834e-12 -7.3363482e-12  2.2228997e-11  9.7587207e-13  0 0 0 0 2
  7.6238812e-12  4.0927765e-11 -1.2336729e-10 -5.7156295e-12  1 0 0 0 2
  3.6527714e-11  1.9400336e-10  -5.838349e-10 -2.6260267e-11  2 0 0 0 2
 -4.2136146e-11  -2.233631e-10  6.7215321e-10  3.0916467e-11  0 1 0 0 2
 -5.0948869e-12 -2.7345113e-11  8.2429539e-11  3.6893333e-12  1 1 0 0 2
 -2.1987408e-13 -1.1547206e-12  3.0075458e-12 -5.2364238e-13  0 2 0 0 2
  5.1238815e-13  1.0076342e-12  -1.937843e-12  6.6830476e-13  0 0 1 0 2
  6.9999396e-12  3.6648538e-11 -1.1005401e-10 -4.9761142e-12  1 0 1 0 2
   1.056871e-12  5.7454533e-12  -1.728405e-11 -6.7273886e-13  0 1 1 0 2
  1.5622033e-12  8.4577859e-12 -2.5867974e-11  -2.311759e-12  0 0 2 0 2
 -9.7279336e-12 -5.2012487e-11  1.5639736e-10  6.6500974e-12  0 0 0 1 2
 -8.7907757e-13 -5.5868128e-12  1.6868174e-11  -1.527299e-13  1 0 0 1 2
 -2.7579054e-13  3.2865148e-13 -1.0540506e-12  1.7646753e-12  0 1 0 1 2
  1.5222505e-13  1.6924893e-12 -5.0673866e-12  6.1913607e-13  0 0 1 1 2
  3.4116823e-14 -1.5698231e-13   4.405595e-13 -4.7388941e-13  0 0 0 2 2
 -2.0866828e-14 -9.2414119e-14  3.0069762e-13 -5.6152583e-14  0 0 0 0 3
 -1.9795669e-13 -4.5963077e-13   1.399166e-12  6.2522031e-13  1 0 0 0 3
  4.8262026e-14  3.5024754e-14 -9.9829368e-14 -2.1728458e-13  0 1 0 0 3
 -1.8195173e-14 -1.6405695e-13  4.7962404e-13 -6.6760601e-14  0 0 1 0 3
  7.2175099e-15  3.8171398e-14 -1.2416566e-13 -4.6143075e-14  0 0 0 1 3
  6.4310678e-14  3.0525274e-14  -9.063245e-14 -3.2750003e-13  0 0 0 0 4


----------[ 2024-10-01 00:00:00 ] # start GEP:

# FT origin is 16.5 cm above beam height
#sbs.gemorigin_xyz = -0.165 0.0 3.685

# global alignment with single C foil suggests GEM first layer is at
#sbs.gemorigin_xyz = -0.1522 -0.0079 3.5719 

# let's put this entry in here in case it's "mandatory"
#sbs.gemangles_xyz = 0.0 0.0 0.0

# updated global FT alignment after internal alignment with straight-through:
sbs.gemorigin_xyz =    -0.153507   -0.0068747      3.61869
sbs.gemangles_xyz =    0.0702184    -0.393578     0.352327


# optics coordinate system is centered at beam height (probably not ideal but that's what g4sbs optics fitting code uses):
sbs.optics_origin = 0.0 0.0 3.685

sbs.polarimetermode = 1

sbs.z0analyzer = 1.473
sbs.analyzerthick = 0.5588
sbs.nbinsz_fcp = 11

# test GEP tracking mode:
sbs.geptrackingmode = 1       

# backward (reconstruction) optics; second-order, generated from proton gun simulation for nominal production field setting from GEP1_map.table:

sbs.optics_order = 2

# total number of terms = 21
# Expansion is: u = sum_{i,j,k,l,m}=0^{i+j+k+l+m<=order} Cu_{ijklm} xfp^i * yfp^j * xpfp^k * ypfp^l * xtar^m, 
# u = xptar, yptar, ytar, p*thetabend. Columns are:
#          Cxptar          Cyptar           Cytar     Cpthetabend   i j k l m

sbs.optics_parameters = 
    0.00078856096  -0.00010131974  -6.3604981e-05         0.37793   0 0 0 0 0
       0.45898121    0.0037914425    -0.005407484     0.024153003   1 0 0 0 0
      0.013218306    -0.011588751       1.0181871     0.023609791   0 1 0 0 0
      -0.69775171    -0.010972748     0.017757347    -0.090699329   0 0 1 0 0
     -0.036792632       1.0090904      -3.6747168     -0.08950457   0 0 0 1 0
   -7.1033758e-14  -6.8610155e-14   2.3088784e-13   3.1064651e-13   0 0 0 0 1
     0.0099152368    -0.010420737      0.01351245    -0.039506558   2 0 0 0 0
       0.34215404      0.20483322     -0.47689438   -0.0089253976   1 1 0 0 0
     -0.007659533      0.12669509     -0.50535499      0.45413844   0 2 0 0 0
     -0.041099371     0.054032244    -0.066621395      0.27692646   1 0 1 0 0
      -0.41274224     -0.65857706       1.7244243      -0.0328807   0 1 1 0 0
      0.021815148    -0.069062598     0.080867341     -0.41843544   0 0 2 0 0
       -1.3629925     -0.47787956       1.2125276    -0.037523093   1 0 0 1 0
       0.19862223       -1.017858       3.8959675      -2.9328066   0 1 0 1 0
        1.7512247       1.5760692      -4.4131006      0.27867981   0 0 1 1 0
      -0.52747476       1.9592603      -7.3316054       5.1023318   0 0 0 2 0
    5.8243841e-14  -6.1894561e-16   3.7903413e-14  -5.7907316e-13   1 0 0 0 1
     4.707113e-14  -4.5049001e-14   1.7004957e-13  -1.0664237e-13   0 1 0 0 1
   -2.3902401e-15   1.6700427e-14  -6.0116568e-14  -2.7458119e-15   0 0 1 0 1
    1.0502042e-14   -1.132494e-14   4.4486126e-14  -1.6751446e-14   0 0 0 1 1
    3.3833467e-15  -2.1656193e-15   6.5612358e-15  -5.1871183e-14   0 0 0 0 2

# forward optics: needed for front-tracker "region-of-interest" calculation:

sbs.forwardoptics_order = 2

# Expansion is: u = sum_{i,j,k,l,m}=0^{i+j+k+l+m<=order} Cu_{ijklm} xptar^i * yptar^j * ytar^k * (1/p)^l * xtar^m, 
# u = xfp, yfp, xpfp, ypfp. Columns are:
#            Cxfp            Cyfp           Cxpfp           Cypfp   i j k l m
sbs.forwardoptics_parameters = 
      0.001739767   0.00024818564    0.0009948161   9.5924062e-05   0 0 0 0 0
        3.6678342   -0.0085579773       0.9838167   -0.0026936077   1 0 0 0 0
     -0.013055225       3.7394468   -0.0040499224        1.040119   0 1 0 0 0
    -0.0026441709        1.028679   -0.0011796726      0.01918605   0 0 1 0 0
      -0.58807436   -0.0024408303     -0.38156548   -0.0014911472   0 0 0 1 0
    -5.348771e-12  -1.0935417e-12   1.2523023e-14   -3.564867e-13   0 0 0 0 1
      -0.21410397     0.024686395     -0.14706443      0.01287812   2 0 0 0 0
       0.20484338     -0.57519723     0.038697583     -0.17790225   1 1 0 0 0
      -0.53983235     0.070040385      -0.2185084     0.049278773   0 2 0 0 0
       -2.0864328     -0.32952741     0.015902011     -0.10613743   1 0 1 0 0
      -0.50812304      0.29564401     -0.15082064      0.10879848   0 1 1 0 0
      -0.09107155      0.12186259    -0.041588388      0.04600298   0 0 2 0 0
        0.1474422     0.025432015      0.12200193    0.0097869902   1 0 0 1 0
      0.032678795     -0.23631894     0.020907898     -0.20032249   0 1 0 1 0
     -0.012762014     -0.11647699  -0.00085585086    -0.090815039   0 0 1 1 0
     -0.020377718    0.0032603906     -0.02021395    0.0037616728   0 0 0 2 0
   -2.4717178e-13  -4.7900499e-14  -5.1077984e-15  -1.7523465e-14   1 0 0 0 1
   -1.7670788e-13   -1.032431e-13   1.4415484e-14    -2.73952e-14   0 1 0 0 1
    7.8871597e-13   1.2400948e-13   -3.876326e-15   3.9610578e-14   0 0 1 0 1
    -1.614311e-12  -5.8047148e-13   5.9378907e-15  -1.7700551e-13   0 0 0 1 1
   -2.8135079e-13   -3.716516e-14   3.6293964e-16  -1.1691786e-14   0 0 0 0 2


# set initial constraint offsets and widths for testing:

# for real data, set wider limits (or perhaps no limits) until we understand what's going on with the GEM alignments:
# we'll keep these here for now until done with global straight-through alignment:
#sbs.frontconstraint_x0 = -0.006 0.0
#sbs.frontconstraint_y0 = 0.0 0.0
#sbs.frontconstraintwidth_x = 0.035 0.025
#sbs.frontconstraintwidth_y = 0.06 0.025

#sbs.backconstraint_x0 = 0.0 0.0
#sbs.backconstraint_y0 = 0.0 0.0
#sbs.backconstraintwidth_x = 0.06 0.3
#sbs.backconstraintwidth_y = 0.06 0.3

# constraints after alignment, AJRP 4/21/2025:
sbs.frontconstraint_x0 = -0.006 0.0
sbs.frontconstraint_y0 = -0.003 0.0
sbs.frontconstraintwidth_x = 0.035 0.025
sbs.frontconstraintwidth_y = 0.03 0.025

sbs.backconstraint_x0 = -0.008 0.07
sbs.backconstraint_y0 = -0.003 0.017
sbs.backconstraintwidth_x = 0.04 0.25
sbs.backconstraintwidth_y = 0.035 0.25




---------[ 2025-04-13 18:06:00 ] # getting ready for zero-field running

sbs.geptrackingmode = 0
sbs.polarimetermode = 1

sbs.usedynamicconstraint = 1

sbs.dynamicphslope = 0.1
sbs.dynamicthslope = 0.1
sbs.dynamicph0 = 0.0
sbs.dynamicth0 = 0.0

# for real data, set wider limits (or perhaps no limits) until we understand what's going on with the GEM alignments:
sbs.frontconstraint_x0 = 0.0166 0.05
sbs.frontconstraint_y0 = -0.0167 0.0
sbs.frontconstraintwidth_x = 0.04 0.15
sbs.frontconstraintwidth_y = 0.03 0.15

sbs.backconstraint_x0 = -0.0164 0.0296
sbs.backconstraint_y0 = -0.0096 -0.011
sbs.backconstraintwidth_x = 0.03 0.2
sbs.backconstraintwidth_y = 0.02 0.2

# attempting to update these after alignment: needed offsets "should" be ~zero now
sbs.frontconstraint_x0 = -0.0059 0.01
sbs.frontconstraint_y0 = -0.0038 -0.007
sbs.frontconstraintwidth_x = 0.025 0.12
sbs.frontconstraintwidth_y = 0.029 0.1

sbs.backconstraint_x0 = -0.0084 0.041
sbs.backconstraint_y0 = 0.0005 0.0167
sbs.backconstraintwidth_x = 0.038 0.15
sbs.backconstraintwidth_y = 0.036 0.15

--------[ 2025-04-14 17:19:00 ] # done with zero-field, back to field-on running

sbs.geptrackingmode = 1
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 0

# set initial constraint offsets and widths for testing:

# for real data, set wider limits (or perhaps no limits) until we understand what's going on with the GEM alignments:
#sbs.frontconstraint_x0 = -0.01 0.0
#sbs.frontconstraint_y0 = -0.01 0.0
#sbs.frontconstraintwidth_x = 0.03 0.07
#sbs.frontconstraintwidth_y = 0.03 0.07


#sbs.backconstraint_x0 = -0.02 0.037
#sbs.backconstraint_y0 = -0.0125 0.0
#sbs.backconstraintwidth_x = 0.03 0.3
#sbs.backconstraintwidth_y = 0.03 0.25


# for real data, set wider limits (or perhaps no limits) until we understand what's going on with the GEM alignments:
# temporarily relax front tracker region-of-interest constraints after realignment:
#sbs.frontconstraint_x0 = 0.0 0.0
#sbs.frontconstraint_y0 = 0.0 0.0
#sbs.frontconstraintwidth_x = 0.06 0.07
#sbs.frontconstraintwidth_y = 0.06 0.07

#sbs.backconstraint_x0 = 0.0 0.0
#sbs.backconstraint_y0 = 0.0 0.0
#sbs.backconstraintwidth_x = 0.06 0.3
#sbs.backconstraintwidth_y = 0.06 0.3

# constraints after alignment, AJRP 4/21/2025:
sbs.frontconstraint_x0 = -0.006 0.0
sbs.frontconstraint_y0 = -0.003 0.0
sbs.frontconstraintwidth_x = 0.035 0.05
sbs.frontconstraintwidth_y = 0.03 0.05

sbs.backconstraint_x0 = -0.008 0.07
sbs.backconstraint_y0 = -0.003 0.017
sbs.backconstraintwidth_x = 0.04 0.35
sbs.backconstraintwidth_y = 0.035 0.35

--------[ 2025-05-05 00:00:00 ] # start kin 3


# here the main change needed (initially) is a new optics model (forward and backward):

# changing optics origin to reflect SBS survey offset:
sbs.optics_origin = 0.0 0.0 3.714

# starting with GEM origin from previous global alignment, adding 2.8 cm to the
# z offset. This global alignment will need to be redone of course
#sbs.gemorigin_xyz =    -0.153507   -0.0068747      3.61869
#sbs.gemorigin_xyz =    -0.153507   -0.0068747      3.648
#sbs.gemangles_xyz =    0.0702184    -0.393578     0.352327

sbs.gemorigin_xyz =    -0.147446  -0.00258276      3.61066
sbs.gemangles_xyz =   -0.0290593    -0.342306     0.309045

sbs.optics_order = 2

# replacing old coefficients with updated proton gun simulations accounting for survey offsets:
# total number of terms = 21
# Expansion is: u = sum_{i,j,k,l,m}=0^{i+j+k+l+m<=order} Cu_{ijklm} xfp^i * yfp^j * xpfp^k * ypfp^l * xtar^m, 
# u = xptar, yptar, ytar, p*thetabend. Columns are:
#          Cxptar          Cyptar           Cytar     Cpthetabend   i j k l m
sbs.optics_parameters = 
    8.0895916e-05  -0.00049039118    0.0011079288      0.66667862   0 0 0 0 0
       0.45157674    0.0052485383    -0.010834743    0.0098745771   1 0 0 0 0
      0.010268812    -0.019180197       1.0470545     0.033331617   0 1 0 0 0
      -0.68365665    -0.017491071     0.038757897    -0.033062291   0 0 1 0 0
      -0.02843851       1.0481547      -3.8317431     -0.16016801   0 0 0 1 0
    4.3955429e-14   2.8153743e-14  -7.7507428e-14   1.7358714e-13   0 0 0 0 1
      0.014401165    -0.022402688     0.041466907    -0.038927947   2 0 0 0 0
       0.51518767      0.18533766     -0.44384439    -0.064942865   1 1 0 0 0
      0.051122835     0.028932772     -0.16206695      0.81306965   0 2 0 0 0
     -0.057710738      0.13470467     -0.26060194      0.19517264   1 0 1 0 0
      -0.71204891     -0.59380256       1.5785597      0.18130516   0 1 1 0 0
      0.034869551     -0.19706728      0.40324194     -0.15209314   0 0 2 0 0
       -2.0357351     -0.45485705       1.1594505      0.13006557   1 0 0 1 0
      -0.25009152      -0.2591533       1.2773413      -5.1417083   0 1 0 1 0
        2.9148538       1.5104698      -4.1934443     -0.32321029   0 0 1 1 0
        0.2756614      0.51537972      -2.3807251       8.9140871   0 0 0 2 0
   -6.2203387e-13   2.7769879e-13  -7.6727631e-13   3.5022084e-12   1 0 0 0 1
   -8.3939423e-13   2.6369691e-13   -8.359979e-13   4.4495503e-13   0 1 0 0 1
    1.5013262e-14  -3.6565471e-14   1.3454079e-13  -1.4330048e-13   0 0 1 0 1
   -2.2799911e-13   7.0052094e-14  -2.1962422e-13   2.4364109e-13   0 0 0 1 1
   -4.4466211e-14   2.1208022e-14  -6.0082639e-14   2.9570217e-13   0 0 0 0 2
   

sbs.forwardoptics_order = 2

# total number of terms = 21
# Expansion is: u = sum_{i,j,k,l,m}=0^{i+j+k+l+m<=order} Cu_{ijklm} xptar^i * yptar^j * ytar^k * (1/p)^l * xtar^m, 
# u = xfp, yfp, xpfp, ypfp. Columns are:
#            Cxfp            Cyfp           Cxpfp           Cypfp   i j k l m

sbs.forwardoptics_parameters =
     0.0017040293   3.4593942e-05   0.00084178661   3.7345985e-05   0 0 0 0 0
        3.6964054   -0.0062815943      0.98539642   -0.0026820685   1 0 0 0 0
     -0.010759657       3.7485937   -0.0038026302       1.0278897   0 1 0 0 0
     0.0022030488       1.0166014   0.00045148572     0.011923387   0 0 1 0 0
       -1.0158533   -0.0025862612     -0.66667504   -0.0021350941   0 0 0 1 0
   -5.4223986e-14  -7.6067624e-15  -7.9220484e-14   1.5998921e-14   0 0 0 0 1
       -0.1690864     0.020979908     -0.11516621    0.0098555786   2 0 0 0 0
       0.28611525     -0.52579079     0.016139289     -0.18937172   1 1 0 0 0
      -0.54431209     0.077922572     -0.23755392     0.055837756   0 2 0 0 0
       -3.0146204     -0.30867201    0.0058269893     -0.11706896   1 0 1 0 0
       -0.5498662      0.14097823      -0.1729077     0.068280383   0 1 1 0 0
     -0.066403218     0.028602219    -0.040699211    0.0051230186   0 0 2 0 0
       0.24744066     0.090629548      0.19645596     0.044651645   1 0 0 1 0
       0.12222631     -0.27940771     0.080578178     -0.26883276   0 1 0 1 0
     -0.013752179     -0.14463474    0.0048985291     -0.12394561   0 0 1 1 0
     -0.065546725     0.015248278    -0.064248968     0.017518439   0 0 0 2 0
    -2.717878e-14   4.2425048e-14  -1.6241999e-14   1.1268872e-14   1 0 0 0 1
    3.1681472e-14   2.3899665e-14   1.6874848e-14   3.1777695e-15   0 1 0 0 1
    7.1036926e-15   6.0864942e-15   8.4761842e-15   -2.936155e-16   0 0 1 0 1
      1.98409e-15  -7.5958771e-14   1.2249967e-14  -3.1717196e-14   0 0 0 1 1
   -2.5110122e-15  -9.2254763e-16  -2.1759938e-15   4.5146178e-16   0 0 0 0 2


# start with same constraints from Kin. 1.
# start with relatively loose constraints until we figure out how to center things:
sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0
sbs.frontconstraintwidth_x = 0.05 0.05
sbs.frontconstraintwidth_y = 0.05 0.05

sbs.backconstraint_x0 = 0.0 0.0
sbs.backconstraint_y0 = 0.0 0.0
sbs.backconstraintwidth_x = 0.05 0.5
sbs.backconstraintwidth_y = 0.05 0.5

---------[ 2025-05-09 10:30:00 ] # Start C-foil zero-field runs.
sbs.geptrackingmode = 0
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 1

sbs.dynamicphslope = 0.1
sbs.dynamicthslope = 0.1
sbs.dynamicph0 = 0.0
sbs.dynamicth0 = 0.0

sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0
sbs.frontconstraintwidth_x = 0.1 0.2
sbs.frontconstraintwidth_y = 0.1 0.2

sbs.backconstraint_x0 = 0.0 0.0
sbs.backconstraint_y0 = 0.0 0.0
sbs.backconstraintwidth_x = 0.015 0.5
sbs.backconstraintwidth_y = 0.03 0.5

---------[ 2025-05-09 20:00:00 ] # Begin production running on LH2 with field ON.
sbs.geptrackingmode = 1
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 0

sbs.frontconstraint_x0 = 0.005 0.0
sbs.frontconstraint_y0 = 0.0 0.002
sbs.frontconstraintwidth_x = 0.041 0.025
sbs.frontconstraintwidth_y = 0.036 0.025

sbs.backconstraint_x0 = 0.0066 0.062
sbs.backconstraint_y0 = 0.0 -0.023
sbs.backconstraintwidth_x = 0.05 0.25
sbs.backconstraintwidth_y = 0.045 0.21

---------[ 2025-05-23 17:00:00 ] # Start C-foil zero-field runs taken after GEM work in Hall. FPP L0 L1 and L4 L5 were pulled out.
sbs.geptrackingmode = 0
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 1

sbs.dynamicphslope = 0.1
sbs.dynamicthslope = 0.1
sbs.dynamicph0 = 0.0
sbs.dynamicth0 = 0.0

sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0
sbs.frontconstraintwidth_x = 0.1 0.2
sbs.frontconstraintwidth_y = 0.1 0.2

sbs.backconstraint_x0 = 0.0 0.0
sbs.backconstraint_y0 = 0.0 0.0
sbs.backconstraintwidth_x = 0.015 0.5
sbs.backconstraintwidth_y = 0.03 0.5

---------[ 2025-05-23 20:00:00 ] # Begin production running on LH2 with field ON.
sbs.geptrackingmode = 1
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 0

sbs.frontconstraint_x0 = 0.005 0.0
sbs.frontconstraint_y0 = 0.0 0.002
sbs.frontconstraintwidth_x = 0.041 0.025
sbs.frontconstraintwidth_y = 0.036 0.025

sbs.backconstraint_x0 = 0.0066 0.062
sbs.backconstraint_y0 = 0.0 -0.023
sbs.backconstraintwidth_x = 0.05 0.25
sbs.backconstraintwidth_y = 0.045 0.21

---------[ 2025-05-29 20:40:00 ] # Multi-foil optics runs. SBS current 1756.5 A (same as production). Beam currents 1-1.5 uA. Used 4 foil and 2 foil optics targets with the corresponding run numbes 4200 and 4203. 
sbs.geptrackingmode = 0
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 1

sbs.dynamicphslope = 0.1
sbs.dynamicthslope = 0.1
sbs.dynamicph0 = 0.0
sbs.dynamicth0 = -0.05

sbs.frontconstraint_x0 = 0.0 0.0
sbs.frontconstraint_y0 = 0.0 0.0
sbs.frontconstraintwidth_x = 0.1 0.5
sbs.frontconstraintwidth_y = 0.1 0.3

sbs.backconstraint_x0 = 0.0 0.0
sbs.backconstraint_y0 = 0.0 0.0
sbs.backconstraintwidth_x = 0.02 0.5
sbs.backconstraintwidth_y = 0.02 0.5


---------[ 2025-05-30 00:45:00 ] # Back to production running.
sbs.geptrackingmode = 1
sbs.polarimetermode = 1
sbs.usedynamicconstraint = 0

sbs.dynamicphslope = 0.1
sbs.dynamicthslope = 0.1
sbs.dynamicph0 = 0.0
sbs.dynamicth0 = 0.0 

sbs.frontconstraint_x0 = 0.005 0.0
sbs.frontconstraint_y0 = 0.0 0.002
sbs.frontconstraintwidth_x = 0.041 0.025
sbs.frontconstraintwidth_y = 0.036 0.025

sbs.backconstraint_x0 = 0.0066 0.062
sbs.backconstraint_y0 = 0.0 -0.023
sbs.backconstraintwidth_x = 0.05 0.25
sbs.backconstraintwidth_y = 0.045 0.21